<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>dash-webapp-template.seqapp.callbacks API documentation</title>
<meta name="description" content="&#39;Callbacks&#39; are what enable the &#34;reactive&#34; functionality
of a Python Dash web application (literally, the react.js).
Every time a user interacts with …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>dash-webapp-template.seqapp.callbacks</code></h1>
</header>
<section id="section-intro">
<p>'Callbacks' are what enable the "reactive" functionality
of a Python Dash web application (literally, the react.js).
Every time a user interacts with a UI component on the web
app page in their browser, a callback with matching Input
(via the component's 'id' attribute) from this module is
activated, thus allowing customized programmed reactions
to any individual and/or series of any [possible combi-
nation of] user actions.</p>
<blockquote>
<p>dash-webapp-template
C a l l b a c k s
𝕄𝕠𝕕𝕦𝕝𝕖
ண⎤꜒𓇃𓇃𓇃ཥ⅌ཤ𓇃𓇃𓇃𓋏ཀཫ𓋏𓇃𓇃𓇃╗╔𓇃𓇃𓆽⦄༽⸶⸷༼⦃𓆽𓇃𓇃𓇃𓇊𓊢ༀ࿐࿓𓇊࿑</p>
</blockquote>
<h2 id="john-collins-github-public-repos-dash-webapp-template">John Collins GitHub Public Repos — dash-webapp-template</h2>
<p>To learn more about callbacks, see:
<a href="https://dash.plot.ly/getting-started-part-2">https://dash.plot.ly/getting-started-part-2</a></p>
<blockquote>
<pre><code>                    ୡ      ୡୡ         ୡ
              ◖𓇃ⴶ〰⸅‖⸄〰ж𓇃𓇃𓇃𓇃⸠⎫𓏉⎧⸡𓇃𓇃𓇃𓏟𓏞𓇃𓇃╗╔𓇃𓇃𓇃𓐩𓋥⸶⸷𓋥𓐩◗
    ୡ     ୡ                 ୡୡ
 ◖𓇃𓇃𓇃𓏣🜾𓏣𓇃𓇃𓉽𓇃𓎸𓈌𓎹𓇃⎨⎬𓇃˥⎡𓇃𓇃࿅𓇃𓊢ꃊ𓊢𓇃𓇃𓇃◗
</code></pre>
</blockquote>
<h2 id="attributes">Attributes:</h2>
<pre><code>logger (logging.Logger):
    Current session log file
version (str):
    Current git-committed source codebase version

           ____________________________
ୡ
</code></pre>
<p>𓇃𓏣🜾𓏣𓇃࿑</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;&#39;Callbacks&#39; are what enable the &#34;reactive&#34; functionality
of a Python Dash web application (literally, the react.js).
Every time a user interacts with a UI component on the web
app page in their browser, a callback with matching Input
(via the component&#39;s &#39;id&#39; attribute) from this module is
activated, thus allowing customized programmed reactions
to any individual and/or series of any [possible combi-
nation of] user actions.


&gt; dash-webapp-template
&gt;    C a l l b a c k s
&gt;          𝕄𝕠𝕕𝕦𝕝𝕖
&gt; ண⎤꜒𓇃𓇃𓇃ཥ⅌ཤ𓇃𓇃𓇃𓋏ཀཫ𓋏𓇃𓇃𓇃╗╔𓇃𓇃𓆽⦄༽⸶⸷༼⦃𓆽𓇃𓇃𓇃𓇊𓊢ༀ࿐࿓𓇊࿑

## John Collins GitHub Public Repos — dash-webapp-template

To learn more about callbacks, see:
https://dash.plot.ly/getting-started-part-2

&gt;                         ୡ      ୡୡ         ୡ
&gt;                   ◖𓇃ⴶ〰⸅‖⸄〰ж𓇃𓇃𓇃𓇃⸠⎫𓏉⎧⸡𓇃𓇃𓇃𓏟𓏞𓇃𓇃╗╔𓇃𓇃𓇃𓐩𓋥⸶⸷𓋥𓐩◗
&gt;         ୡ     ୡ                 ୡୡ
&gt;      ◖𓇃𓇃𓇃𓏣🜾𓏣𓇃𓇃𓉽𓇃𓎸𓈌𓎹𓇃⎨⎬𓇃˥⎡𓇃𓇃࿅𓇃𓊢ꃊ𓊢𓇃𓇃𓇃◗

Attributes:
----------
    logger (logging.Logger):
        Current session log file
    version (str):
        Current git-committed source codebase version

               ____________________________
    ୡ
𓇃𓏣🜾𓏣𓇃࿑

&#34;&#34;&#34;
import os
import sys

sys.path.append(os.path.dirname(os.path.realpath(__file__)))

from flask import Flask
from werkzeug.routing import Rule

from .config import *

from .utils import *
from seqapp import app

import config
from config import *

import bioinfo as bioinformatics
from bioinfo import pipeline, visualization
from bioinfo.pipeline import (
    parse_contents,
)

version = VERSION

logger = logging.getLogger(__name__)


########################################
#  S T A N D A R D  F U N C T I O N S  #
########################################
&#34;&#34;&#34; See the app.utils module &amp; also the /app/config init file
    for some of the more general, non-reactive functions which may
    nonetheless be imported and used in the callbacks below.
&#34;&#34;&#34;


########################################
#    F L A S K  F U N C T I O N S      #
########################################
&#34;&#34;&#34; The dash.Dash() app object is itself at its core a flask app
    object, too; thus, all of the [vast] Flask source code
    functionalities are compatible as-is with Dash apps.
&#34;&#34;&#34;

app.server.url_map.add(Rule(&#39;/&#39;, endpoint=&#39;downloadZAll&#39;))
app.server.url_map.add(Rule(&#39;/&#39;, endpoint=&#39;urlToDownload&#39;))

@app.server.endpoint(&#34;/downloadZAll&#34;)
def download_all_selected():
    &#34;&#34;&#34;Send path from directory to allow user to
    download zipped files as an attachment.

    Returns:
        File download directly to user&#39;s PC.
    &#34;&#34;&#34;
    value = flask.request.args.get(&#34;value&#34;)
    fbn = f&#34;{os.path.basename(value)}&#34;
    app.logger.info(f&#34;🗽| REQUEST TO DOWNLOAD: for [zipped] server file @ {value}&#34;)
    return flask.send_from_directory(
        directory=f&#34;{os.path.dirname(value)}&#34;,
        filename=fbn,
        attachment_filename=fbn,
        as_attachment=True,
        mimetype=&#34;zip&#34;,
    )


@app.server.endpoint(&#34;/urlToDownload&#34;)
def download_file():
    &#34;&#34;&#34;Send path from directory to allow user
       to download file as an attachment.

    Returns:
    &#34;&#34;&#34;
    value = flask.request.args.get(&#34;value&#34;)
    fbn = f&#34;{os.path.basename(value)}&#34;
    app.logger.info(f&#34;🗽| REQUEST TO DOWNLOAD: for server file @ {value}&#34;)
    mime = &#34;text/plain&#34; if &#34;png&#34; not in value else &#34;image/png&#34;
    return flask.send_from_directory(
        directory=f&#34;{os.path.dirname(value)}&#34;,
        filename=fbn,
        attachment_filename=fbn,
        as_attachment=True,
        mimetype=mime,
    )


########################################
#  C A L L B A C K  F U N C T I O N S  #
########################################
&#34;&#34;&#34; Every callback function is preceded by a special `@app.callback`
    Python decorator function, which necessarily has an Output() and
    at least one Input() parameter (both objects from dash.dependencies).
    Optionally, a callback function decorator can also contain a
    State() parameter (also imported from dash.dependencies).

    Typically, the return of a callback function is an html.Div()
    object containing a list of updated components to be returned to
    the UI via the &#39;id&#39; attribute indicated on the Output() object
    of callback decorator.

    For a helpful overview on Python decorators, see:
    https://realpython.com/primer-on-python-decorators/
&#34;&#34;&#34;

@app.callback(
    Output(f&#34;user-login-confirmation&#34;, &#34;children&#34;),
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;input-user-name&#34;, &#34;value&#34;),
        Input(f&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
        Input(f&#34;session&#34;, &#34;data&#34;),
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;)
    ],
    [State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;)],
)
def confirm_new_session(
    n_clicks,
    user_sign_on,
    clear_n_clicks,
    session_data,
    logout,
    login_timestamp,
):
    &#34;&#34;&#34;Responsive components generation for user sign-on at top of app UI page.

    Parameters
    ----------
    n_clicks : int
        Total cumulative count of clicks &#39;submit&#39; (sign-in) button
    user_sign_on : str
        Selected user name from sign on dropdown
    clear_n_clicks : int
        Total cumulative count of clicks clear pipeline button
    session_data : Dash.dcc.Store(type=&#39;session&#39;)
        Dash HTTP client-side memory caching, &#34;Session&#34; type (auto-cleared when
        browser tab closes [but *not* on Refresh&#39;s]).
    logout : int
        Total cumulative count of clicks logout button
    login_timestamp : int
        Timestamp at most recent sign on button click as integer
        (e.g., 1572843293129)

    &#34;&#34;&#34;
    if user_sign_on == &#34;None&#34; and logout &lt; 1:
        raise PreventUpdate

    if not user_sign_on:
        return [
            html.H6(
                &#34;Please sign in to create a new session.&#34;,
                style={&#34;fontSize&#34;: &#34;1.2rem&#34;, &#34;fontWeight&#34;: &#34;300&#34;},
            )
        ]

    try:
        enter_user = session_data[&#34;current_user&#34;]
        user_proper = session_data[&#34;user_proper&#34;]
        putat_user = user_sign_on[0] + user_sign_on.split(&#34;_&#34;)[0].lower()[1:]
        try:
            prev_user = session_data[f&#34;SIGN_ON-№{n_clicks-1}&#34;]
        except KeyError as e:
            prev_user = &#34;NONE&#34;
        app.logger.debug(f&#34;Recorded user name: {enter_user} (Prev. user={prev_user})&#34;)
        if login_timestamp:
            submit_t_elapsed = tns() / 1e9 - login_timestamp / 1e3
            app.logger.debug(f&#34;USER LOGIN : `submit_t_elapsed` = {submit_t_elapsed}&#34;)
        else:
            submit_t_elapsed = 0  # &lt;1 ≡ No recent sign in!
        if (
            user_sign_on == enter_user
            or session_data[&#34;user_logged_in&#34;] == &#34;True&#34;
        ) and submit_t_elapsed &lt; 1:
            log_t_init = session_data[&#34;login_t_init&#34;]
            session_log_file = session_data[&#34;session_log_file&#34;]
            RUN_ID = session_data[&#34;RUN_ID&#34;]
            app.logger.info(
                f&#34;* C R E A T E D  N E W  &#39;Current SESSION OUTPUT DIR&#39; *\n{session_data[&#39;PATH_TO_SESSION_OUTPUT&#39;]}&#34;
            )
            return html.Details(
                [
                    html.Div(
                        [
                            html.Span(
                                f&#34;Active User Account — {enter_user.replace(&#39;_&#39;, &#39; &#39;).title()}&#34;,
                                style={
                                    &#34;fontSize&#34;: &#34;1.2rem&#34;,
                                    &#34;fontFamily&#34;: &#34;&#39;Open Sans&#39;, sans-serif&#34;,
                                    &#34;fontWeight&#34;: &#34;300&#34;,
                                    &#34;color&#34;: &#34;#304479&#34;,
                                },
                            ),
                            html.Span(
                                className=&#34;fader-line-short&#34;, style={&#34;marginBottom&#34;: &#34;20px&#34;}
                            ),
                            html.P(&#34;You&#39;re all set!&#34;),
                            html.H6(f&#34;Sign-on Timestamp:&#34;),
                            html.H4(f&#34;{log_t_init.split(&#39;=&#39;)[1]}&#34;),
                            html.P(
                                f&#34;Current RUN ID:\t{RUN_ID}&#34;,
                                style={
                                    &#34;animation&#34;: &#34;anim-text-flow-keys 10s infinite linear&#34;,
                                    &#34;mixBlendMode&#34;: &#34;difference&#34;,
                                    &#34;fontSize&#34;: &#34;0.9rem&#34;,
                                },
                            ),
                        ],
                        className=&#34;updates-list&#34;,
                    ),
                    html.Summary(
                        html.Code(
                            f&#34;✔ LOGGED IN&#34;,
                            style={&#34;color&#34;: &#34;rgb(24, 230, 112)&#34;},
                            className=&#34;updates-header&#34;,
                        )
                    ),
                ],
                id=&#34;logged-in-status&#34;,
            )
        elif n_clicks &gt; 1 and prev_user != &#34;None yet..&#34; and enter_user != prev_user:
            return [
                html.Br(),
                html.H4(
                    f&#34;{putat_user}, would you like to sign on [&amp; log out {prev_user}]?&#34;,
                    style={&#34;display&#34;: &#34;block&#34;},
                ),
                html.P(f&#34;🧙🧠🗲⚛ 👌📓⬸📖🖊&#34;, style={&#34;fontSize&#34;: &#34;3rem&#34;}),
            ]

    except Exception as e:
        user_proper = &#34;⚠:[USER_UNKNOWN!]&#34;
        app.logger.warning(f&#34;Note: Exception raised during user sign on: {e}&#34;)

    return [
        html.Br(),
        html.H6(&#34;Sign In ( ⮩️🚪✨ ) to create a new, blank output directory for your analysis.&#34;),
    ]


@app.callback(
    Output(f&#34;input-user-name&#34;, &#34;value&#34;),
    [
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;log-back-in-submit&#34;, &#34;n_clicks&#34;),
    ],
    [
        State(f&#34;log-out-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;log-back-in-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        State(f&#34;local&#34;, &#34;data&#34;),
    ],
)
def log_out_or_comeback(
    logout,
    quick_logback,
    log_out_timestamp,
    sign_on_timestamp,
    logback_on_timestamp,
    signon,
    user_profile,
):
    &#34;&#34;&#34;Enable USER &#34;Log Out&#34; functionality.

    Parameters
    ----------
    logout : int
        Total cumulative count of clicks log out button
    quick_logback : int
        Total cumulative count of clicks &#34;Return&#34; button
    log_out_timestamp : int
        Timestamp of last user click log out button
    sign_on_timestamp : int
        Timestamp of last user click sign-in button
    logback_on_timestamp : int
        Timestamp of last user click &#34;Return&#34; button
    signon : int
        Total cumulative count of clicks user sign-in button
    user_profile : Dash.dcc.Store(type=&#39;local&#39;)
        Browser-cached local app memory, containing stored saved
        user &#34;profile&#34; info / stats.
    &#34;&#34;&#34;
    if not user_profile:
        raise PreventUpdate
    if logout &lt; 1 and quick_logback &lt; 1:
        raise PreventUpdate
    if quick_logback &gt; 0:
        if signon &gt; 0 and logout &gt; 0:
            if logback_on_timestamp &gt; max(log_out_timestamp, sign_on_timestamp):
                return user_profile[&#34;userAccount&#34;]
        elif signon &lt; 1:
            return user_profile[&#34;userAccount&#34;]
    elif logout &gt; 0 and signon &gt; 0:
        if log_out_timestamp &gt; sign_on_timestamp:
            return &#34;None&#34;


@app.callback(
    [
        Output(f&#34;session&#34;, &#34;data&#34;),
        Output(f&#34;local&#34;, &#34;data&#34;),
    ],
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
    ],
    [
        State(f&#34;input-user-name&#34;, &#34;value&#34;),
        State(f&#34;session&#34;, &#34;data&#34;),
        State(f&#34;local&#34;, &#34;data&#34;),
        State(f&#34;initiate-pipeline&#34;, &#34;n_clicks&#34;),
        State(f&#34;initiate-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;clear-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;log-out-submit&#34;, &#34;n_clicks_timestamp&#34;),
    ],
)
def record_user_name(
    login_n_clicks,
    logout_n_clicks,
    clear_pl_n_clicks,
    user_selection,
    data,
    local_cache,
    init_pl_n_clicks,
    initiate_pipeline_timestamp,
    clear_pipeline_timestamp,
    user_login_timestamp,
    refresh_uploads_timestamp,
    log_out_timestamp,
):
    &#34;&#34;&#34;Upon user sign on (or sign off), correspondingly update the cached
    information describing the current user (e.g., name, proper name, sign
    in history, etc.) and create and store a new RUN ID for the current
    session, as applicable.

    Args:
        login_n_clicks (int):
            Total cumulative count of clicks user sign-in button
        logout_n_clicks (int):
            Total cumulative count of clicks log out button
        clear_pl_n_clicks (int):
            Total cumulative count of clicks clear results button
        user_selection (str):
            Selected value from user names dropdown in app log-in section
        data (Dash.dcc.Store):
            [Session] HTTP client-side memory cache
        local_cache (Dash.dcc.Store):
            [Local] HTTP client-side memory cache
        init_pl_n_clicks (int):
            Total cumulative count of clicks initiate step 2 pipeline button
        initiate_pipeline_timestamp (int):
            Timestamp of last user click initiate step 2 pipeline button
        clear_pipeline_timestamp (int):
            Timestamp of last user click clear results button
        user_login_timestamp (int):
            Timestamp of last user click sign-in button
        refresh_uploads_timestamp (int):
            Timestamp of last user click refresh uploads button
        log_out_timestamp (int):
            Timestamp of last user click log out button
    &#34;&#34;&#34;
    app.logger.debug(f&#34;sign on timestamp: {user_login_timestamp}&#34;)
    reset_session_data = {
        &#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;,
        &#34;RUN_ID&#34;: &#34;NA&#34;,
        &#34;current_user&#34;: &#34;None&#34;,
        &#34;user_logged_in&#34;: &#34;False&#34;,
        &#34;user_proper&#34;: &#34;NA&#34;,
    }
    if login_n_clicks &lt; 1 or user_selection == &#34;None&#34; or not user_selection:
        if not user_selection:
            return (
                reset_session_data,
                local_cache,
            )
        else:
            data = {&#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;}
            data[&#34;RUN_ID&#34;] = &#34;NA&#34;
            data[&#34;current_user&#34;] = user_selection
            data[&#34;login n_clicks&#34;] = login_n_clicks
            data[&#34;user_logged_in&#34;] = &#34;False&#34;
            data[&#34;user_proper&#34;] = user_selection.replace(&#34;_&#34;, &#34; &#34;).title().split()[0]
            return data, local_cache

    login_t_elapse = tns() / 1e9 - user_login_timestamp / 1e3
    UUID = f&#34;{&#39;&#39;.join([*map(lambda x: x[:2], user_selection.split(&#39;_&#39;))])}&#34;
    logins = f&#34;SIGN_ON-№{login_n_clicks}&#34;
    data = data or {&#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;}
    data[&#34;UUID&#34;] = UUID
    user_proper = user_selection[0] + user_selection.split(&#34;_&#34;)[0].lower()[1:]
    data[&#34;user_proper&#34;] = user_proper
    data[&#34;current_user&#34;] = user_selection
    data[&#34;login n_clicks&#34;] = login_n_clicks

    if (login_n_clicks &gt; logout_n_clicks and user_selection != &#34;None&#34;) and login_t_elapse &lt; 2:
        data[&#34;user_logged_in&#34;] = &#34;True&#34;

    if logout_n_clicks &gt; 0:
        if (tns() / 1e9 - log_out_timestamp / 1e3) &lt; 2:
            return reset_session_data, local_cache

    if not user_selection:
        data[&#34;user_logged_in&#34;] = &#34;None&#34;
        return data, local_cache

    # Proceed with apparent sign-in submission if this point reached:
    login_t_init = f&#34;{tns()} = {now()}&#34;
    data[&#34;login_t_init&#34;] = login_t_init
    data[logins] = user_selection
    if &#34;SIGN_ON-№1&#34; in data.keys():
        data[&#34;prev_user&#34;] = data[f&#34;SIGN_ON-№{max(login_n_clicks-1,1)}&#34;]

    RUN_ID = f&#34;APP_RUNID_{now()}&#34;
    SESSION_OUTPUT_DIR = f&#34;{RUN_OUTPUT_DIR}/{today()}/{RUN_ID}/&#34;
    data[&#34;RUN_ID&#34;] = RUN_ID
    data[&#34;PATH_TO_SESSION_OUTPUT&#34;] = SESSION_OUTPUT_DIR

    session_log_file = f&#34;{SESSION_OUTPUT_DIR}{RUN_ID}_CurrentSession.log&#34;
    os.makedirs(SESSION_OUTPUT_DIR, exist_ok=True)
    app.logger.debug(f&#34;Number of logger handlers: {logger.handlers}&#34;)
    fh = add_logfile(logfile=session_log_file, logger=logger)
    app.logger.addHandler(fh)
    app.logger.debug(f&#34;Number of logger handlers: {logger.handlers}&#34;)

    app.logger.info(f&#34;USER SIGN ON @ {login_t_init}&#34;)
    app.logger.info(f&#34;*** CURRENT APP APP SOFTWARE VERSION = {VERSION} ***&#34;)
    data[&#34;session_log_file&#34;] = session_log_file
    data[&#34;SESSION_DATA&#34;] = pd.DataFrame(
        [[RUN_ID, SESSION_OUTPUT_DIR, user_selection, session_log_file]],
        columns=[&#34;RUN_ID&#34;, &#34;PATH_TO_SESSION_OUTPUT&#34;, &#34;USER_ID&#34;, &#34;LOG_FILE&#34;],
    ).to_json(date_format=&#34;iso&#34;, orient=&#34;split&#34;)
    app.logger.info(f&#34;USER: &#39;{user_selection}&#39; | RUN ID: {RUN_ID}&#34;)

    # Store basic user profile in browser local cache for  app:
    reset_local_cache = {
        &#34;userName&#34;: user_proper,
        &#34;userAccount&#34;: user_selection,
        &#34;userProfileCreated&#34;: now(),
        &#34;countUserLogIns&#34;: 0,
        &#34;userRuns&#34;: {RUN_ID: data},
    }
    try:
        if local_cache[&#34;userAccount&#34;] != user_selection:
            local_cache = reset_local_cache
        local_cache[&#34;countUserLogIns&#34;] += 1
        local_cache[&#34;userRuns&#34;][RUN_ID] = data
    except Exception as e:
        app.logger.info(
            f&#34;Creating {user_proper}&#39;s first local memory cache! (I.e., by which to remember them by! 😉)&#34;
        )
        local_cache = reset_local_cache
        local_cache[&#34;countUserLogIns&#34;] += 1

    return data, local_cache


@app.callback(
    Output(f&#34;user-status&#34;, &#34;children&#34;),
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;refresh-user-history&#34;, &#34;n_clicks&#34;),
        Input(f&#34;session&#34;, &#34;data&#34;),
    ],
    [State(f&#34;input-user-name&#34;, &#34;value&#34;), State(f&#34;local&#34;, &#34;data&#34;)],
)
def show_user_in_menubar(
    sign_on_n_clicks, save_results_n_clicks, session_data, selected_username, local_data_cache
):
    &#34;&#34;&#34;
    Parameters
    ----------
    sign_on_n_clicks
        int
    save_results_n_clicks
        int
    session_data
        Dash.dcc.Store(type=&#39;session&#39;)
    selected_username
        str
    local_data_cache
        Dash.dcc.Store(type=&#39;local&#39;)
    &#34;&#34;&#34;
    log_in = [
        html.Span(
            html.A([&#34;⁂ Sign In&#34;], href=f&#34;#log-in-below&#34;),
            style={&#34;fontSize&#34;: &#34;80%&#34;, &#34;color&#34;: &#34;goldenrod&#34;},
            id=f&#34;log-in&#34;,
        )
    ]
    if session_data and sign_on_n_clicks &gt; 0:
        if &#34;session_log_file&#34; in session_data:
            if session_data[&#34;current_user&#34;] != &#34;None&#34;:
                user = session_data[&#34;user_proper&#34;]
                USER = session_data[&#34;current_user&#34;]

                default = []
                history = {}
                try:
                    history = local_data_cache[f&#34;{USER}_APP_Saved_History&#34;]
                    app.logger.debug(str(local_data_cache), str(history))
                except Exception as e:
                    history = {}
                    default = [html.Li(f&#34;You have no saved APP Results History, yet!\n&#34;)]
                return [
                    html.Details(
                        [
                            html.Summary(
                                [
                                    html.Span(
                                        f&#34;👤Signed in as: {user}&#34;,
                                        style={
                                            &#34;fontFamily&#34;: &#34;Muli&#34;,
                                            &#34;fontSize&#34;: &#34;85%&#34;,
                                            &#34;cursor&#34;: &#34;pointer&#34;,
                                        },
                                        className=&#34;user-menu-summary&#34;,
                                    )
                                ]
                            ),
                            html.Div(
                                [
                                    html.Ul(
                                        [
                                            html.Li(f&#34;Current RUN_ID: {session_data[&#39;RUN_ID&#39;]}&#34;),
                                            html.Li(
                                                f&#34;User Is Logged In: {session_data[&#39;user_logged_in&#39;]}&#34;,
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(37, 109, 210)&#34;},
                                            ),
                                            html.Li(
                                                f&#34;Signed On @ {session_data[&#39;login_t_init&#39;]}&#34;,
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(17, 199, 210)&#34;},
                                            ),
                                            html.Li(
                                                [
                                                    html.A(
                                                        &#34;Your Saved Analysis History&#34;,
                                                        href=&#34;#save-user-results&#34;,
                                                    ),
                                                    html.Ul(
                                                        [
                                                            html.Li(dcc.Link(f&#34;{k}&#34;, href=f&#34;/{k}&#34;))
                                                            for k in history.keys()
                                                        ]
                                                        + default,
                                                        style={
                                                            &#34;listStyle&#34;: &#34;decimal-leading-zero&#34;,
                                                            &#34;margin&#34;: &#34;0!important&#34;,
                                                            &#34;padding&#34;: &#34;0!important&#34;,
                                                        },
                                                    ),
                                                ],
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(37, 149, 180)&#34;},
                                            ),
                                            html.Li(
                                                [
                                                    html.A(
                                                        &#34;Report an Issue/Bug&#34;,
                                                        href=&#34;mailto:jcollins.bioinformatics@gmail.com&#34;,
                                                    )
                                                ],
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(7, 69, 180)&#34;},
                                            ),
                                        ]
                                    )
                                ],
                                className=&#34;user-menu&#34;,
                                style={&#34;color&#34;: &#34;rgb(199, 199, 199)&#34;},
                            ),
                        ]
                    )
                ]
    return log_in


@app.callback(Output(f&#34;workflow-selection&#34;, &#34;children&#34;), [Input(f&#34;workflow-id&#34;, &#34;value&#34;)])
def update_workflow_choice(workflow):
    &#34;&#34;&#34;Update display at top of app based on USER&#39;s Worlflow selection
    (e.g., &#34;Gene Editing: [...]&#34;, etc.)
    
    Args:
        workflow: str
    
    Returns:
        Array of H2 HTML Header element containing workflow text.
    &#34;&#34;&#34;
    app.logger.debug(f&#34;CALLBACK:::`update_workflow_choice` triggered with value: {workflow}&#34;)
    return [html.H2(f&#34;{workflow}&#34;, style={&#34;textAlign&#34;: &#34;center&#34;})]


@app.callback(Output(&#34;dd2-dropdown&#34;, &#34;options&#34;), [Input(&#34;dd1-dropdown&#34;, &#34;value&#34;)])
def update_dropdown(dd1):
    &#34;&#34;&#34;Update Dropdown for sample corresponding to USER-selected ID.
    
    Args:
        dd1 (Array of &#34;label&#34;:&#34;value&#34; pairs dictionary containing the): Dropdown&#39;s options.
    
    Returns:
        Updated array matching form of input.
    &#34;&#34;&#34;
    app.logger.debug(f&#34;CALLBACK:::`update_dropdown` triggered with value: {dd1}&#34;)
    if dd1 and dd1 != &#34;None&#34;:
        ent_id, ent_name, = dd1.split(&#34;-&#34;)
        try:
            wells = entity_schemas.loc[ent_name].columns #.unique()
        except KeyError as e:
            app.logger.info(f&#34;WellID dropdown error in Plasmid Tool:\n{e}&#34;)
            return [{&#34;label&#34;: &#34;——N/A——&#34;, &#34;value&#34;: &#34;Error&#34;}]
        # ⤑⟗αβ⟗⇒ *Trigger Ligation*
        return [{&#34;label&#34;: &#34; ✔ Confirm Well &amp; EXP ID&#34;, &#34;value&#34;: &#34;None&#34;}] + [
            {&#34;label&#34;: w, &#34;value&#34;: w}
            for w in wells
        ]
    else:
        return [{&#34;label&#34;: &#34;——N/A——&#34;, &#34;value&#34;: &#34;None&#34;}]


@app.callback(
    Output(&#34;submission-status&#34;, &#34;children&#34;),
    [Input(&#34;submit-selected-dds&#34;, &#34;n_clicks&#34;), Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)],
    [State(&#34;dd1-dropdown&#34;, &#34;value&#34;), State(&#34;dd2-dropdown&#34;, &#34;value&#34;)],
)
def trigger_dropdowns(submit_n_clicks, clear_n_clicks, dd1, dd2):
    &#34;&#34;&#34;Initiate first analysis

    Args:
        submit_n_clicks: int
        clear_n_clicks: int
        dd1: str
        dd2: str

    Returns:
        Dash html component(s)
    &#34;&#34;&#34;
    if clear_n_clicks == submit_n_clicks + 1:
        return html.Code(
            &#34;⚠ | ℹ Overclicking clear *may* require compensatory submits! (I.e., Try clicking submit button &gt;1 times, if submissions are not going through.)&#34;,
            style={
                &#34;color&#34;: &#34;red&#34;,
                &#34;display&#34;: &#34;flex&#34;,
                &#34;flexFlow&#34;: &#34;column wrap&#34;,
                &#34;fontSize&#34;: &#34;1.0rem&#34;,
                &#34;margin&#34;: &#34;0px 30% 20px 30%&#34;,
            },
        )
    if all(ui not in (&#34;None&#34;, None) for ui in [dd1, dd2]):
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;trigger_dropdowns&#39;) has been activated, and now has value &#39;submit_n_clicks&#39; = {submit_n_clicks}&#34;
        )
        return [html.Code(f&#34;SUBMISSION for: {dd1}, @Well{dd2}&#34;)]
    elif clear_n_clicks &gt; submit_n_clicks + 1:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;trigger_dropdowns&#39;) has been cleared, and now has value &#39;clear_n_clicks&#39; = {clear_n_clicks}&#34;
        )
        return html.Code(
            f&#34;Submissions cleared: {clear_n_clicks}, [submissions_count={submit_n_clicks}].&#34;,
            style={&#34;fontStyle&#34;: &#34;normal&#34;, &#34;color&#34;: &#34;gray&#34;, &#34;margin&#34;: &#34;0px 30% 20px 30%&#34;},
        )
    else:
        return html.Code(&#34;No submissions received, it seems...&#34;)



@app.callback(
    Output(&#34;dd-selections&#34;, &#34;children&#34;),
    [
        Input(&#34;dd1-dropdown&#34;, &#34;value&#34;),
        Input(&#34;dd2-dropdown&#34;, &#34;value&#34;),
        Input(&#34;submit-dds&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;),
        Input(&#34;workflow-id&#34;, &#34;value&#34;),
    ],
    [State(&#34;session&#34;, &#34;data&#34;), State(&#34;submit-selected-dds&#34;, &#34;n_clicks_timestamp&#34;)],
)
def display_generated_dd_output(
    dd1,
    dd2,
    submission,
    clear_submission,
    workflow,
    session_data,
    submission_timestamp,
):
    &#34;&#34;&#34;Generic template for a paired dynamics set of dropdowns;
    such that the user selection in the first dropdown dynamically
    modifies live the possible options in the second dropdown.

    Args:
        dd1: str
        dd2: str
        submission: int
        clear_submission: int
        workflow: str
        session_data: Dash.dcc.Store(type=&#39;session&#39;)
        submission_timestamp: int
    &#34;&#34;&#34;

    if (dd1 == &#34;None&#34; and dd2 == &#34;None&#34;) or dd1 is None:
        return [
            html.Div(
                [
                    html.Span(
                        f&#34;Make a new selection.&#34;,
                        style={&#34;textAlign&#34;: &#34;center&#34;, &#34;fontFamily&#34;: &#34;Muli&#34;, &#34;fontSize&#34;: &#34;1.5rem&#34;},
                    ),
                    html.Span(
                        html.Img(
                            src=&#34;../assets/animations/dna-minimal-green.gif&#34;,
                            height=&#34;150&#34;,
                            style={
                                &#34;transform&#34;: &#34;translateY(-55px) translateX(5px)&#34;,
                                &#34;filter&#34;: &#34;hue-rotate(100deg) contrast(1.1) saturate(5)&#34;,
                                &#34;position&#34;: &#34;absolute&#34;,
                                &#34;opacity&#34;: &#34;0.5&#34;,
                                &#34;borderRadius&#34;: &#34;250px&#34;,
                            },
                        )
                    ),
                ],
                style={
                    &#34;marginLeft&#34;: &#34;25%&#34;,
                    &#34;position&#34;: &#34;relative&#34;,
                    &#34;textAlign&#34;: &#34;center&#34;,
                    &#34;width&#34;: &#34;50%&#34;,
                    &#34;zIndex&#34;: &#34;-1&#34;,
                },
            ),
            html.Div(
                [
                    html.Span(&#34;↪⦿&#34;),
                    html.Img(
                        src=&#34;../assets/images/scope-unic.png&#34;,
                        width=&#34;80&#34;,
                        style={&#34;marginTop&#34;: &#34;15px&#34;, &#34;marginBottom&#34;: &#34;-25px&#34;, &#34;cursor&#34;: &#34;pointer&#34;},
                    ),
                    html.Span(&#34;⥅♅&#34;),
                ],
                style={
                    &#34;textAlign&#34;: &#34;center&#34;,
                    &#34;fontSize&#34;: &#34;1.75rem&#34;,
                    &#34;animation&#34;: &#34;animateGlow 45s infinite linear!important&#34;,
                    &#34;cursor&#34;: &#34;pointer&#34;,
                },
            ),
        ]
    elif any(ui == &#34;Error&#34; for ui in [dd1, dd2]):
        return
    elif dd1 != &#34;None&#34; and dd2 is None:
        return [
            html.H5(
                f&#34;ℹ | Informational message to display.&#34;,
                style={&#34;textAlign&#34;: &#34;center&#34;, &#34;marginLeft&#34;: &#34;25%&#34;, &#34;width&#34;: &#34;50%&#34;},
            )
        ]
    elif all(ui != &#34;None&#34; for ui in [dd1, dd2]):

        return html.Div(
            [
                html.Code(
                    f&#34;♻ Cleared submission state: [total_clears={clear_submission}]&#34;,
                    style={&#34;fontStyle&#34;: &#34;italic&#34;, &#34;fontSize&#34;: &#34;0.9rem&#34;, &#34;marginBottom&#34;: &#34;5px&#34;},
                ),
                html.Br(),
                html.Div(
                    [
                        html.H6(
                            [
                                html.P(f&#34;⮊ Click ⬫Submit⬫ 𝑓𝗈𝓇⤑{dd2} ~ {dd1}&#34;),
                                html.Span(&#34;to initiate &#34;),
                                html.Span(
                                    f&#34;in silico &#34;,
                                    style={&#34;fontStyle&#34;: &#34;italic&#34;, &#34;fontFamily&#34;: &#34;&#39;Times&#39;, serif&#34;},
                                ),
                                html.Span(&#34;analysis of selections.&#34;),
                            ],
                            style={
                                &#34;textAlign&#34;: &#34;center&#34;,
                                &#34;cursor&#34;: &#34;pointer&#34;,
                                &#34;color&#34;: &#34;#ffffff6e&#34;,
                                &#34;backgroundImage&#34;: &#34;url(https://media.giphy.com/media/4HIOPSXOitJ2o/giphy.gif)&#34;,
                                &#34;mozBackgroundClip&#34;: &#34;text&#34;,
                                &#34;webkitBackgroundClip&#34;: &#34;text&#34;,
                                &#34;fontWeight&#34;: &#34;700&#34;,
                                &#34;backgroundSize&#34;: &#34;60%&#34;,
                            },
                        )
                    ],
                    style={
                        &#34;position&#34;: &#34;absolute&#34;,
                        &#34;margin&#34;: &#34;&#34;&#34;0.5% -5% -5% -5%&#34;&#34;&#34;,
                        &#34;textAlign&#34;: &#34;center&#34;,
                        &#34;display&#34;: &#34;inline-block&#34;,
                        &#34;mixBlendMode&#34;: &#34;lighten&#34;,
                        &#34;width&#34;: &#34;200px&#34;,
                    },
                ),
                html.Br(),
                html.Br(),
                html.Div(
                    [
                        html.Span(&#34;✂&#34;),
                        html.Span(&#34;۝&#34;),
                        html.Span(&#34;⭾&#34;),
                        html.Span(&#34;α/β&#34;),
                        html.Div(
                            [
                                html.Video(
                                    src=f&#34;data:video/mp4;base64,{base64.b64encode(open(f&#39;../assets/animations/T-Cell_TEM_4-3.mp4&#39;, &#39;rb&#39;).read()).decode()}&#34;,
                                    id=&#34;t-cell&#34;,
                                    autoPlay=True,
                                    loop=True,
                                    controls=False,
                                    preload=&#34;true&#34;,
                                    muted=True,
                                )
                            ],
                            style={&#34;filter&#34;: &#34;opacity(0.25)&#34;},
                        ),
                    ],
                    style={
                        &#34;textAlign&#34;: &#34;center&#34;,
                        &#34;fontSize&#34;: &#34;2rem&#34;,
                        &#34;width&#34;: &#34;20%&#34;,
                        &#34;marginLeft&#34;: &#34;40.5%&#34;,
                        &#34;mixBlendMode&#34;: &#34;exclusion&#34;,
                    },
                    className=&#34;animate twirl&#34;,
                ),
            ],
            style={&#34;textAlign&#34;: &#34;center&#34;},
        )


@app.callback(Output(&#34;dd1-dropdown&#34;, &#34;value&#34;), [Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)])
def clear_dd1_selection(n_clicks):
    &#34;&#34;&#34;Clear Dropdown selections for Dropdown #1 (dd1)

    ( Dropdown to clear #1 of 2 )

    Args:
        n_clicks: int

    Returns:
        str: Resets selections to default, blank states.
    &#34;&#34;&#34;
    if n_clicks &gt; 0:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;clear_dd1_selection&#39;) has been activated, and now has value &#39;n_clicks&#39; = {n_clicks}&#34;
        )
        return &#34;None&#34;


@app.callback(
    Output(&#34;dd2-dropdown&#34;, &#34;value&#34;),
    [Input(&#34;dd1-dropdown&#34;, &#34;value&#34;), Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)],
)
def clear_dd2_selection(val, n_clicks):
    &#34;&#34;&#34;Clear Dropdown selections for Dropdown #2 (dd2)

    ( Dropdown to clear #2 of 2 )

    Args:
        val (str): cascading response via `clear_dd2_selection()` callback
        n_clicks: int

    Returns:
        str: Resets selections to default, blank states.
    &#34;&#34;&#34;
    if n_clicks &gt; 0:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;clear_dd2_selection&#39;) has been activated, and now has value &#39;n_clicks&#39; = {n_clicks} &amp; &#39;val&#39; = {val}&#34;
        )
        if val == &#34;None&#34;:
            return &#34;None&#34;
        else:
            return None


@app.callback(
    Output(&#34;memory&#34;, &#34;data&#34;),
    [
        Input(&#34;append-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;refresh-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;upload-data&#34;, &#34;contents&#34;),
    ],
    [
        State(&#34;session&#34;, &#34;data&#34;),
        State(&#34;memory&#34;, &#34;data&#34;),
        State(&#34;append-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;upload-data&#34;, &#34;filename&#34;),
        State(&#34;upload-data&#34;, &#34;last_modified&#34;),
    ],
)
def enable_combined_file_uploads(
    append_nclicks,
    clear_nclicks,
    refresh_nclicks,
    list_of_contents,
    session_data,
    clientside_memory_cache,
    append_nclicks_timestamp,
    refresh_nclicks_timestamp,
    clear_nclicks_timestamp,
    list_of_names,
    list_of_dates,
):
    &#34;&#34;&#34;Management of app components and file upload States allowing for USER-
    toggled continuation of upload (i.e., as opposed to overwriting any previously
    received ABI files uploaded).
    
    Args:
        append_nclicks: int
        clear_nclicks: int
        refresh_nclicks: int
        list_of_contents: list of bytes
        session_data: Dash.dcc.Store(type=&#39;memory&#39;)
        clientside_memory_cache: Dash.dcc.Store(type=&#39;memory&#39;)
        append_nclicks_timestamp: int
        refresh_nclicks_timestamp: int
        clear_nclicks_timestamp: int
        list_of_names: list of str
        list_of_dates: list of int
    &#34;&#34;&#34;
    memory_reset = {}
    if not session_data:
        raise PreventUpdate
    if clear_nclicks &gt; 0:
        t_elapse = tns() / 1e9 - clear_nclicks_timestamp / 1e3
        app.logger.info(f&#34;CLEAR UPLOAD UI ACTION DETECTED, W/ `t_elapse` = {t_elapse}&#34;)
        if t_elapse &lt; 2:
            return memory_reset
    if append_nclicks &gt; 0:
        LOG_FILE = session_data[&#34;session_log_file&#34;]
        RUN_ID = session_data[&#34;RUN_ID&#34;]
        SESSION_OUTPUT_DIR = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
        app.logger.info(f&#34;Append to Uploads in progress...&#34;)
        app.logger.info(f&#34; ...Adding the following files: \n{list_of_names}&#34;)
        memory_reset = {f&#34;{RUN_ID}-list_of_names&#34;: []}
        uploads_cache = clientside_memory_cache or memory_reset
        parsed_upload_children = [
            html.Details(
                [
                    parse_contents(c, n, d, SESSION_OUTPUT_DIR, session_log_file=LOG_FILE)
                    for c, n, d in zip(list_of_contents, list_of_names, list_of_dates)
                ]
            )
        ]
        uploads_cache[f&#34;{RUN_ID}-len_most_recent&#34;] = len(parsed_upload_children)
        uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;].extend(list_of_names)
        uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;] = list(
            set(uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;])
        )
        uploads_cache[f&#34;{RUN_ID}-len_of_contents&#34;] = len(uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;])
        return uploads_cache
    else:
        return memory_reset


for n in range(1000):

    @app.callback(
        Output(f&#34;cmds-dt-{n}&#34;, &#34;style&#34;),
        [Input(f&#34;show-cmds-{n}&#34;, &#34;n_clicks&#34;)],
        [State(f&#34;cmds-dt-{n}&#34;, &#34;style&#34;)],
    )
    def show_pipeline_commands(show_pl_cmds_n_clicks, style):
        &#34;&#34;&#34;Enable dynamic reveal/hide functionality for showing
        the technical-heavy exact command line commands called 
        during the pipeline execution of processes.
        
        Args:
            show_pl_cmds_n_clicks: int
            style: &lt;type&gt;
        
        Returns:
            &lt;type&gt;
        
        Raises:
            PreventUpdate: Description
            PreventUpdate
        &#34;&#34;&#34;
        if show_pl_cmds_n_clicks &gt; 0:
            if (show_pl_cmds_n_clicks % 2) == 1:
                app.logger.info(f&#34;show_pl_cmds clicked: {show_pl_cmds_n_clicks % 2}&#34;)
                return {&#34;display&#34;: &#34;block&#34;}
            else:
                return {&#34;display&#34;: &#34;none&#34;}
        else:
            raise PreventUpdate


@app.callback(
    Output(&#34;output-data-upload&#34;, &#34;children&#34;),
    [
        Input(&#34;upload-data&#34;, &#34;contents&#34;),
        Input(&#34;upload-data&#34;, &#34;filename&#34;),
        Input(&#34;upload-data&#34;, &#34;last_modified&#34;),
        Input(&#34;initiate-pipeline&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
        Input(&#34;append-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;refresh-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;memory&#34;, &#34;data&#34;),
        Input(&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(&#34;session&#34;, &#34;data&#34;),
    ],
    [
        State(&#34;workflow-id&#34;, &#34;value&#34;),
        State(&#34;initiate-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-uploads&#34;, &#34;n_clicks_timestamp&#34;),
    ],
)
def update_output(
    list_of_contents,
    list_of_names,
    list_of_dates,
    initiate_pipeline_n_clicks,
    clear_pipeline_n_clicks,
    append_uploads_n_clicks,
    refresh_uploads_n_clicks,
    clear_uploads_n_clicks,
    memory,
    user_login_n_clicks,
    session_data,
    workflow,
    initiate_pipeline_timestamp,
    clear_pipeline_timestamp,
    user_login_timestamp,
    refresh_uploads_timestamp,
    clear_uploads_timestamp,
):
    &#34;&#34;&#34;Primary APP Pipeline function, as triggered by &#39;Initiate
    [APP] Pipeline&#39; UI button (located in the &#34;Step 2 (2/2)&#34;
    section).
    
    Parameters
    ----------
    list_of_contents
        &lt;list of str&gt;
        Array containing user-uploaded ABI raw contents as
        binary strings (thus requiring decoding)
    list_of_names
        &lt;list of str&gt;
        Array containing user-uploaded ABI filenames
        (does not include the full path for security reasons)
    list_of_dates
        &lt;list of int&gt;
        Array containing user-uploaded ABI last modified timestamps
        (integers as seconds since 1970)
    initiate_pipeline_n_clicks
        &lt;int&gt;
        Total count of UI button clicks
    clear_pipeline_n_clicks
        &lt;int&gt;
        Total count of UI button clicks
    append_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    refresh_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    clear_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    memory
        Dash.dcc.Store(type=&#39;session&#39;)
    user_login_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    session_data
        Dash.dcc.Store(type=&#39;session&#39;)
    workflow
        &lt;type&gt;
    initiate_pipeline_timestamp
        &lt;type&gt;
    clear_pipeline_timestamp
        &lt;type&gt;
    user_login_timestamp
        &lt;type&gt;
    refresh_uploads_timestamp
        &lt;type&gt;
    clear_uploads_timestamp
        &lt;type&gt;
    
    &#34;&#34;&#34;

    def show_list_of_names(USER, list_of_names):
        &#34;&#34;&#34;Display the filenames for all successfully received 
        USER-uploaded ABI files.
        
        Args:
            USER: &lt;str&gt;
                Active user
            list_of_names: &lt;list&gt; 
                List of user-uploaded ABI filenames
        
        Returns:
            &lt;html.Div([...])&gt; 
                Reactive response to display after processing upload
        &#34;&#34;&#34;
        if not all([fn.endswith(tuple([&#34;.csv&#34;,&#34;.xlsx&#34;])) for fn in list_of_names]):
            return html.Div(
                [
                    html.Br(),
                    html.Code(
                        f&#34;⚠ UPLOAD ERROR: Not all of the {len(list_of_names)} files are CSV or Excel files !&#34;,
                        style={&#34;color&#34;: &#34;red&#34;},
                    ),
                    html.Br(),
                    html.Code(
                        f&#34;⛔ | Please reset this upload &amp; then perform a fresh upload of either .csv or .xlsx files.&#34;
                    ),
                ]
            )
        return html.Div(
            [
                html.Br(),
                html.Code(
                    f&#34;✔ UPLOAD SUCCESSFUL (N={len(list_of_names)})&#34;, style={&#34;color&#34;: &#34;green&#34;}
                ),
                html.Br(),
                html.Br(),
                html.Details(
                    [
                        html.Summary(
                            html.H3(
                                f&#34;File(s) received (click to expand)&#34;,
                                style={&#34;textAlign&#34;: &#34;left&#34;, &#34;fontSize&#34;: &#34;120%&#34;},
                            )
                        ),
                        html.Div(
                            [
                                html.Li(f&#34;{&#39;{:02d}&#39;.format(i+1)})\t{abi}&#34;)
                                for (i, abi) in enumerate(sorted(list_of_names))
                            ],
                            id=&#34;files-received&#34;,
                            style={
                                &#34;textAlign&#34;: &#34;left&#34;,
                                &#34;fontSize&#34;: &#34;60%&#34;,
                                &#34;columnCount&#34;: &#34;3&#34;,
                                &#34;paddingBottom&#34;: &#34;2%&#34;,
                                &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                            },
                        ),
                        html.Hr(
                            style={
                                &#34;borderTop&#34;: &#34;1px solid&#34;,
                                &#34;animation&#34;: &#34;pact-gradient-text-flow 3s infinite linear&#34;,
                                &#34;borderRadius&#34;: &#34;5px&#34;,
                                &#34;opacity&#34;: &#34;0.67&#34;,
                                &#34;width&#34;: &#34;50%&#34;,
                                &#34;marginLeft&#34;: &#34;25%&#34;,
                            }
                        ),
                    ]
                ),
                html.Br(),
                html.Span(className=&#34;fader-line-short&#34;, style={&#34;marginBottom&#34;: &#34;20px&#34;}),
            ],
            style={&#34;width&#34;: &#34;80%&#34;, &#34;marginLeft&#34;: &#34;10%&#34;},
        )

    not_signed_in_msg = html.Div(
        [html.H6(&#34;Please log in to release the pipeline as ready for activation.&#34;)]
    )

    try:
        if session_data:  # [&#34;user_logged_in&#34;] == &#34;True&#34;:
            RUN_ID = session_data[&#34;RUN_ID&#34;]
            SESSION_OUTPUT_DIR = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
            LOG_FILE = session_data[&#34;session_log_file&#34;]
            USER = session_data[&#34;user_proper&#34;]
            UUID = session_data[&#34;UUID&#34;]

            if len(app.logger.handlers) &lt; 1:
                app.logger.info(
                    f&#34;Number logger handlers = {len(app.logger.handlers)}-&gt;{logger.handlers}&#34;
                )
                app.logger.info(&#34;Adding log FileHandler...&#34;)
                fh = logging.FileHandler(LOG_FILE)
                fh.setLevel(logging.INFO)
                app.logger.addHandler(fh)
                app.logger.info(
                    f&#34;Number logger handlers = {len(app.logger.handlers)}-&gt;{logger.handlers}&#34;
                )
        else:
            return not_signed_in_msg

    except KeyError as e:
        app.logger.error(f&#34;No user appears to be logged in (KeyError: {e})&#34;)
        return not_signed_in_msg

    ### UPON USER FILE UPLOAD(S):
    if list_of_contents is not None:

        if initiate_pipeline_n_clicks &gt;= 1:
            init_t_elapse = tns() / 1e9 - initiate_pipeline_timestamp / 1e3
            app.logger.info(f&#34;init_t_elapse = {init_t_elapse}; &#34;)
            if init_t_elapse &lt; 30:
                if (
                    clear_pipeline_n_clicks &gt; 0
                    and refresh_uploads_n_clicks &lt;= clear_pipeline_n_clicks
                ):
                    if all(
                        clear_pipeline_timestamp &gt; ts
                        for ts in [initiate_pipeline_timestamp, user_login_timestamp]
                    ):
                        return [
                            html.H3(
                                f&#34;Thanks, {USER}; the previous pipeline results have been cleared.&#34;
                            ),
                            html.H4(f&#34;Current analysis output folder: {RUN_ID}&#34;),
                            html.H5(
                                html.Div(
                                    [
                                        html.Span(f&#34;Launch a new analysis.&#34;),
                                        html.Br(),
                                    ]
                                )
                            ),
                        ]
                elif clear_pipeline_n_clicks &gt; 0:
                    if clear_pipeline_timestamp &gt; initiate_pipeline_timestamp:
                        if refresh_uploads_n_clicks &gt; 0:
                            if refresh_uploads_timestamp &gt; clear_pipeline_timestamp:
                                return show_list_of_names(USER, list_of_names)
                        return html.Div(
                            html.H5(
                                f&#34;(Pipeline results [{RUN_ID}] CLEARED)&#34;, style={&#34;color&#34;: &#34;red&#34;}
                            )
                        )

                app.logger.info(
                    f&#34;📟📶⌁⌁⌁📠Using the following as pipeline data input. \n{len(list_of_names)} USER UPLOADED FILE(S) : \n&#34;
                    + &#34;\n  📊⇢🧬 &#34;.join(
                        [
                            &#34;{:&gt;03d})\t{:&gt;50s}&#34;.format(i + 1, abi)
                            for i, abi in enumerate(sorted(list_of_names))
                        ]
                    )
                )

                app.logger.info(
                    f&#34;INITIALIZING NEW PIPELINE LAUNCH:\n\n\t\t{SESSION_OUTPUT_DIR}&#34;
                )

                start_time = tns()

                children = []
                parsed_upload_children = [
                    html.Details(
                        [
                            parse_contents(c, n, d, SESSION_OUTPUT_DIR, session_log_file=LOG_FILE)
                            for c, n, d in zip(list_of_contents, list_of_names, list_of_dates)
                        ]
                    )
                ]
                # Generate (single!) TCR alpha/beta chain pair combinations
                # base pipeline reference files (e.g., agg&#39;d fq, designated master
                # reference &#39;genome&#39;, DataFrames, log, etc.)
                try:
                    pipeline_output = ljoin(
                        [
                            r
                            for r in pipeline.run_pipeline(
                                RUN_ID,
                                SESSION_OUTPUT_DIR,
                                workflow=workflow,
                                session_log_file=LOG_FILE,
                            )
                        ]
                    )
                    args = [(*(x), i + 1) for i, x in enumerate(pipeline_output)]

                except Exception as e:
                    logs = []
                    report = None
                    with open(LOG_FILE, &#34;r+&#34;) as log_file:
                        for line in log_file.readlines():
                            logs.append(line)
                    stderr = [
                        dcc.Textarea(
                            placeholder=&#34;(Main Sequence -- logger placeholder)&#34;,
                            value=&#34;\n&#34;.join(logs),
                            style={
                                &#34;height&#34;: &#34;400px&#34;,
                                &#34;width&#34;: &#34;50%&#34;,
                                &#34;fontSize&#34;: &#34;0.7rem&#34;,
                                &#34;lineHeight&#34;: &#34;0.9rem&#34;,
                                &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                            },
                            className=&#34;logger-text&#34;,
                            name=&#34;organization&#34;,
                            readOnly=True,
                        )
                    ]
                    fatal_crash = &#34;⚠ ALERT: ERROR IN MAIN PIPELINE SEQUENCE&#34;
                    app.logger.error(f&#34;{fatal_crash}: \n\n{e}&#34;)
                    log_exc(app.logger)
                    return html.Div(
                        [
                            html.H2(fatal_crash, style={&#34;color&#34;: &#34;red&#34;}),
                            html.P(f&#34;App runtime was: {gtt(start_time)}&#34;),
                            html.Code(f&#34;Primary error message for crash:\n{e}&#34;),
                            html.H4(&#34;See [end of] AUDIT LOG (below) for failure reason.&#34;),
                            html.H5(f&#34;WEB SERVER SYSTEM LOG:&#34;, style={&#34;color&#34;: &#34;red&#34;}),
                            html.Div(stderr),
                        ]
                    )

                ###   # # # # # # # # # #### # # # # # # # # #   ###
                children.append(
                    html.Div(
                        [
                            html.Hr(),
                            html.Br(),
                            html.H4(&#34;All files analyzed in most recent upload:&#34;),
                        ]
                    )
                )
                &#34;&#34;&#34;      ~ ◮ ~
                     S U M M A R Y
                 a  n  a  l  y  s  i  s
                     ~     ~     ~
                         ~ ◮ ~
                &#34;&#34;&#34;
                if report:
                    summary_report = [
                        html.Div(
                            [
                                html.Br(),
                                html.H2(
                                    &#34;Pipeline Output Summary&#34;,
                                    style={
                                        &#34;fontSize&#34;: &#34;80%&#34;,
                                        &#34;letterSpacing&#34;: &#34;1.33rem&#34;,
                                        &#34;fontFamily&#34;: &#34;Cinzel&#34;,
                                        &#34;animation&#34;: &#34;anim-text-flow-keys 120s infinite linear&#34;,
                                    },
                            ),
                                html.Hr(),
                            ],
                            style={&#34;width&#34;: &#34;90%&#34;, &#34;marginLeft&#34;: &#34;5%&#34;},
                        )
                    ]
                else:
                    summary_report = [html.Div([html.H4(f&#34;No final output found.&#34;)])]

                html_out = f&#34;{SESSION_OUTPUT_DIR}{RUN_ID}_HTMLprops.tsv&#34;
                pd.DataFrame(
                    [str(c.to_plotly_json()) for c in children], columns=[&#34;DashHTMLDivComponents&#34;]
                ).to_csv(html_out, encoding=&#34;utf-8&#34;, sep=&#34;\t&#34;)
                app.logger.info(&#34;Processed &amp; analzyed input files were:&#34;)
                app.logger.debug(parsed_upload_children)
                app.logger.info(&#34;,&#34;.join([str(type(x)) for x in parsed_upload_children]))
                total_exec_time = gtt(start_time)
                app.logger.info(
                    f&#34;———COMPLETE——-\n\n \t ☆☆☆ Total EXECUTION TIME Required ☆☆☆\n\n \t\t = {total_exec_time} s \n\n&#34;
                )
                show_exec_time = [
                    html.Div(
                        [
                            html.Hr(),
                            html.H3(
                                f&#34;* ﾟ(&gt;͂ ͡͡︒ ͜ ʖ ͡︒)&gt;-｡ﾟ☆* :・ﾟ.☆ * ･ &#34;
                            ),
                            html.H4(f&#34;Total Execution Time Required = {total_exec_time} s&#34;),
                            html.Hr(),
                            html.Br(),
                        ]
                    )
                ]

                if len(children) &gt; 50:
                    full_report = [
                        html.Div(
                            [
                                html.H2(
                                    f&#34;NOTICE: Due to an unusually large number of results in this analysis (N={len(children)}), full report display has been automatically disabled.&#34;
                                )
                            ]
                        )
                    ]
                else:
                    full_report = children

                children = (
                    show_exec_time
                    + TOC
                    + summary_report
                    + full_report
                    + parsed_upload_children
                    + [html.Div(html.Hr())]
                )

                app.logger.debug(&#34;,&#34;.join([str(type(x)) for x in children]))
                app.logger.debug(f&#34;Number of html.Div elements in final layout: {len(children)}&#34;)

                return children

        elif initiate_pipeline_n_clicks &gt; 15:
            return html.Div(
                [
                    html.H4(
                        &#34;⚠ | ALERT ! : Un𝒇ortunately, you have over-activated the pipeline submissions check system. Please re𝒇resh the page, re-log in, and re-upload the set o𝒇 ABI 𝒇iles you would like analyzed.  🛠⎆ &#34;
                    ),
                    html.H6(&#34;↺ Please Re𝒇resh the page. ↺&#34;),
                ]
            )

        if clear_uploads_n_clicks &gt; 0:
            t_elapsed = tns() / 1e9 - clear_uploads_timestamp / 1e3
            if t_elapsed &lt; 2:
                for tcr_dir in os.listdir(SESSION_OUTPUT_DIR):
                    grouped_clone_fqs = f&#34;{SESSION_OUTPUT_DIR}{tcr_dir}&#34;
                    if os.path.isdir(grouped_clone_fqs):
                        shutil.rmtree(grouped_clone_fqs)
                return html.Div(
                    [
                        html.Code(f&#34;UPLOADS CLEARED&#34;, style={&#34;color&#34;: &#34;red&#34;}),
                        html.H5(
                            f&#39;To continue, submit at least one new upload &amp; click &#34;✥ Append&#34;.&#39;
                        ),
                    ]
                )

        if append_uploads_n_clicks &gt; 0 or clear_uploads_n_clicks &gt; 0:
            if len(list_of_names) &gt; 0 and len(memory.items()) &gt; 0:
                all_uploads = (
                    memory[f&#34;{RUN_ID}-list_of_names&#34;]
                    if len(memory[f&#34;{RUN_ID}-list_of_names&#34;]) &gt; 0
                    else list_of_names
                )
                return show_list_of_names(USER, all_uploads)
            elif len(memory.items()) == 0:
                return html.Div(html.Code(&#34;NONE&#34;))
        else:
            app.logger.info(
                f&#34;{USER} uploaded the following {len(list_of_names)} file(s):&#34;
                + &#34;\n\t ◇ 📄 &#34;
                + &#34;\n\t ◇ 📄 &#34;.join(sorted(list_of_names))
                + &#34;.\n&#34;
            )
            return show_list_of_names(USER, list_of_names)

    else:
        return html.Div(
            [html.Br(), html.H5(f&#34;Logged in as: {USER}&#34;, style={&#34;color&#34;: &#34;rgb(32,92,188)&#34;})]
        )




@app.callback(
    Output(f&#34;output-file-list&#34;, &#34;children&#34;),
    [Input(f&#34;refresh-downloads-links&#34;, &#34;n_clicks&#34;)],
    [State(f&#34;download-dropdown&#34;, &#34;value&#34;), State(f&#34;session&#34;, &#34;data&#34;)],
)
def update_link(refresh_n_clicks, value, session_data):
    &#34;&#34;&#34;&#34;Download Output Files&#34; dropdown components suite.

    Allows user to choose from a list of file &#39;genres&#39; (i.e.,
    subsets of similar bioinformatics datafile types) - and
    reacts by displaying all corresponding generated results
    files for the current session analysis up-to-now, which
    dual, and principally serve their purpose, as direct-to-
    desktop functional download links.

    Also capable of showing a full printout of the current cum-
    ulative state of the session logfile in via an HTML
    textarea Dash component.

    Finally, users are also presented (via HTML button comp)
    the option and ability to create a click-to-download link
    for a dynamically generated zipped archive of all curr-
    ently selected (&amp; thus [reactively] displayed) results
    files.

    Args:
    -----
        refresh_n_clicks           :  int
        value                      :  str
        session_data (dcc.Store(   :  Dash HTTP client-side memory caching,
            type=&#39;session&#39;)        . &#34;Session&#34; type (auto-cleared when browser
                      )            .  tab closes [but *not* on Refresh&#39;s]).

    Returns:
    --------
        html.Div([html.Li&#39;s])      :  An array of download-enabling Dash HTML
                                      hyperlink components.

    &#34;&#34;&#34;
    if value:
        if session_data:
            selection = output_filetype_genres[value]
            try:
                session_output = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
            except KeyError as e:
                app.logger.info(
                    f&#34;User attempting to access files when not yet logged in!\nError:\n{e}&#34;
                )
                return [html.Li(f&#34;(Please log in first!)&#34;)]
            if value == &#34;LOGS&#34;:
                files = sorted(get_output_files(selection, session_output))
                logs = []
                for f in files:
                    with open(f, &#34;r+&#34;) as log_file:
                        for line in log_file.readlines():
                            logs.append(line)
                    if len(app.logger.handlers) &lt; 1:
                        app.logger.addHandler(add_logfile(f))
                        app.logger.info(&#34;Re-added logfile (post-log printout)&#34;)
                return [html.Li(file_download_link(filename)) for filename in files] + [
                    dcc.Textarea(
                        placeholder=&#34;(No logged activity yet.)&#34;,
                        value=&#34;\n&#34;.join(logs),
                        style={
                            &#34;height&#34;: &#34;550px&#34;,
                            &#34;width&#34;: &#34;60%&#34;,
                            &#34;fontSize&#34;: &#34;0.7rem&#34;,
                            &#34;lineHeight&#34;: &#34;0.9rem&#34;,
                            &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                        },
                        className=&#34;logger-text&#34;,
                        name=&#34;organization&#34;,
                        readOnly=True,
                    )
                ]
            elif value == &#34;REF&#34;:
                return [
                    html.Li(
                        file_download_link(filename),
                        style={&#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;, &#34;letterSpacing&#34;: &#34;-1pt&#34;},
                    )
                    for filename in sorted(get_output_files(selection))
                ]
            files = get_output_files(selection, session_output)
            if len(files) == 0:
                return [html.Li(f&#34;No output files available for selection: {value}.&#34;)]
            else:
                return [
                    html.Li(
                        file_download_link(filename),
                        style={&#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;, &#34;letterSpacing&#34;: &#34;-1pt&#34;},
                    )
                    for filename in sorted(files)
                ]
        else:
            return [html.Li(f&#34;(Please log in first!)&#34;)]
    else:
        return [html.Li(f&#34;[Select an output filetype(s) category.]&#34;)]


@app.callback(
    Output(f&#34;download-all&#34;, &#34;children&#34;),
    [Input(f&#34;request-all-zipped&#34;, &#34;n_clicks&#34;)],
    [State(f&#34;download-dropdown&#34;, &#34;value&#34;), State(f&#34;session&#34;, &#34;data&#34;)],
)
def zip_all_downloadables(getZipped_n_clicks, value, session_data):
    &#34;&#34;&#34;Create a downloadable zip of USER selected set of output files.
    
    Args:
        getZipped_n_clicks: int
        value: str
        session_data: Dash.dcc.Store(type=&#39;session&#39;)
    
    Returns:
        html.Div([]): Dash HTML div component↦ itself an array of Dash HTML components
    &#34;&#34;&#34;
    if getZipped_n_clicks &gt; 0 and any(session_data):
        selection = output_filetype_genres[value]
        session_output = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
        RUN_ID = session_data[&#34;RUN_ID&#34;]
        source = session_output if value != &#34;REF&#34; else PLASMIDS_ARCHIVE
        files = get_output_files(selection, final_output_dir=source)
        zipped = re.sub(&#34;[&#39;\ \(\)]&#34;, &#34;&#34;, f&#34;{session_output}{RUN_ID}_{clock()[-4:]}.zip&#34;)
        for i, filename in enumerate(files):
            fbn = f&#34;{os.path.basename(filename)}&#34;
            app.logger.info(f&#34;{i}: Adding file {filename} to new zipped archive: {fbn}...&#34;)
            with zipfile.ZipFile(zipped, &#34;a&#34;) as zipf:
                zipf.write(filename, fbn)
        return html.Div(
            [
                html.H4(f&#34;Zip⇝⇶🗃⇨Download All:&#34;),
                html.H4([html.Li(file_download_link(zipped), className=&#34;zip-dl-link&#34;)]),
            ]
        )</code></pre>
</details>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-variables">Global variables</h2>
<dl>
<dt id="dash-webapp-template.seqapp.callbacks.logger"><code class="name">var <span class="ident">logger</span></code></dt>
<dd>
<div class="desc"><p>See the app.utils module &amp; also the /app/config init file
for some of the more general, non-reactive functions which may
nonetheless be imported and used in the callbacks below.</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="dash-webapp-template.seqapp.callbacks.clear_dd1_selection"><code class="name flex">
<span>def <span class="ident">clear_dd1_selection</span></span>(<span>n_clicks)</span>
</code></dt>
<dd>
<div class="desc"><p>Clear Dropdown selections for Dropdown #1 (dd1)</p>
<p>( Dropdown to clear #1 of 2 )</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>n_clicks</code></strong></dt>
<dd>int</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>Resets selections to default, blank states.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(Output(&#34;dd1-dropdown&#34;, &#34;value&#34;), [Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)])
def clear_dd1_selection(n_clicks):
    &#34;&#34;&#34;Clear Dropdown selections for Dropdown #1 (dd1)

    ( Dropdown to clear #1 of 2 )

    Args:
        n_clicks: int

    Returns:
        str: Resets selections to default, blank states.
    &#34;&#34;&#34;
    if n_clicks &gt; 0:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;clear_dd1_selection&#39;) has been activated, and now has value &#39;n_clicks&#39; = {n_clicks}&#34;
        )
        return &#34;None&#34;</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.clear_dd2_selection"><code class="name flex">
<span>def <span class="ident">clear_dd2_selection</span></span>(<span>val, n_clicks)</span>
</code></dt>
<dd>
<div class="desc"><p>Clear Dropdown selections for Dropdown #2 (dd2)</p>
<p>( Dropdown to clear #2 of 2 )</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>val</code></strong> :&ensp;<code>str</code></dt>
<dd>cascading response via <code><a title="dash-webapp-template.seqapp.callbacks.clear_dd2_selection" href="#dash-webapp-template.seqapp.callbacks.clear_dd2_selection">clear_dd2_selection()</a></code> callback</dd>
<dt><strong><code>n_clicks</code></strong></dt>
<dd>int</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>Resets selections to default, blank states.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(&#34;dd2-dropdown&#34;, &#34;value&#34;),
    [Input(&#34;dd1-dropdown&#34;, &#34;value&#34;), Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)],
)
def clear_dd2_selection(val, n_clicks):
    &#34;&#34;&#34;Clear Dropdown selections for Dropdown #2 (dd2)

    ( Dropdown to clear #2 of 2 )

    Args:
        val (str): cascading response via `clear_dd2_selection()` callback
        n_clicks: int

    Returns:
        str: Resets selections to default, blank states.
    &#34;&#34;&#34;
    if n_clicks &gt; 0:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;clear_dd2_selection&#39;) has been activated, and now has value &#39;n_clicks&#39; = {n_clicks} &amp; &#39;val&#39; = {val}&#34;
        )
        if val == &#34;None&#34;:
            return &#34;None&#34;
        else:
            return None</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.confirm_new_session"><code class="name flex">
<span>def <span class="ident">confirm_new_session</span></span>(<span>n_clicks, user_sign_on, clear_n_clicks, session_data, logout, login_timestamp)</span>
</code></dt>
<dd>
<div class="desc"><p>Responsive components generation for user sign-on at top of app UI page.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>n_clicks</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks 'submit' (sign-in) button</dd>
<dt><strong><code>user_sign_on</code></strong> :&ensp;<code>str</code></dt>
<dd>Selected user name from sign on dropdown</dd>
<dt><strong><code>clear_n_clicks</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks clear pipeline button</dd>
<dt><strong><code>session_data</code></strong> :&ensp;<code>Dash.dcc.Store(type='session')</code></dt>
<dd>Dash HTTP client-side memory caching, "Session" type (auto-cleared when
browser tab closes [but <em>not</em> on Refresh's]).</dd>
<dt><strong><code>logout</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks logout button</dd>
<dt><strong><code>login_timestamp</code></strong> :&ensp;<code>int</code></dt>
<dd>Timestamp at most recent sign on button click as integer
(e.g., 1572843293129)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;user-login-confirmation&#34;, &#34;children&#34;),
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;input-user-name&#34;, &#34;value&#34;),
        Input(f&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
        Input(f&#34;session&#34;, &#34;data&#34;),
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;)
    ],
    [State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;)],
)
def confirm_new_session(
    n_clicks,
    user_sign_on,
    clear_n_clicks,
    session_data,
    logout,
    login_timestamp,
):
    &#34;&#34;&#34;Responsive components generation for user sign-on at top of app UI page.

    Parameters
    ----------
    n_clicks : int
        Total cumulative count of clicks &#39;submit&#39; (sign-in) button
    user_sign_on : str
        Selected user name from sign on dropdown
    clear_n_clicks : int
        Total cumulative count of clicks clear pipeline button
    session_data : Dash.dcc.Store(type=&#39;session&#39;)
        Dash HTTP client-side memory caching, &#34;Session&#34; type (auto-cleared when
        browser tab closes [but *not* on Refresh&#39;s]).
    logout : int
        Total cumulative count of clicks logout button
    login_timestamp : int
        Timestamp at most recent sign on button click as integer
        (e.g., 1572843293129)

    &#34;&#34;&#34;
    if user_sign_on == &#34;None&#34; and logout &lt; 1:
        raise PreventUpdate

    if not user_sign_on:
        return [
            html.H6(
                &#34;Please sign in to create a new session.&#34;,
                style={&#34;fontSize&#34;: &#34;1.2rem&#34;, &#34;fontWeight&#34;: &#34;300&#34;},
            )
        ]

    try:
        enter_user = session_data[&#34;current_user&#34;]
        user_proper = session_data[&#34;user_proper&#34;]
        putat_user = user_sign_on[0] + user_sign_on.split(&#34;_&#34;)[0].lower()[1:]
        try:
            prev_user = session_data[f&#34;SIGN_ON-№{n_clicks-1}&#34;]
        except KeyError as e:
            prev_user = &#34;NONE&#34;
        app.logger.debug(f&#34;Recorded user name: {enter_user} (Prev. user={prev_user})&#34;)
        if login_timestamp:
            submit_t_elapsed = tns() / 1e9 - login_timestamp / 1e3
            app.logger.debug(f&#34;USER LOGIN : `submit_t_elapsed` = {submit_t_elapsed}&#34;)
        else:
            submit_t_elapsed = 0  # &lt;1 ≡ No recent sign in!
        if (
            user_sign_on == enter_user
            or session_data[&#34;user_logged_in&#34;] == &#34;True&#34;
        ) and submit_t_elapsed &lt; 1:
            log_t_init = session_data[&#34;login_t_init&#34;]
            session_log_file = session_data[&#34;session_log_file&#34;]
            RUN_ID = session_data[&#34;RUN_ID&#34;]
            app.logger.info(
                f&#34;* C R E A T E D  N E W  &#39;Current SESSION OUTPUT DIR&#39; *\n{session_data[&#39;PATH_TO_SESSION_OUTPUT&#39;]}&#34;
            )
            return html.Details(
                [
                    html.Div(
                        [
                            html.Span(
                                f&#34;Active User Account — {enter_user.replace(&#39;_&#39;, &#39; &#39;).title()}&#34;,
                                style={
                                    &#34;fontSize&#34;: &#34;1.2rem&#34;,
                                    &#34;fontFamily&#34;: &#34;&#39;Open Sans&#39;, sans-serif&#34;,
                                    &#34;fontWeight&#34;: &#34;300&#34;,
                                    &#34;color&#34;: &#34;#304479&#34;,
                                },
                            ),
                            html.Span(
                                className=&#34;fader-line-short&#34;, style={&#34;marginBottom&#34;: &#34;20px&#34;}
                            ),
                            html.P(&#34;You&#39;re all set!&#34;),
                            html.H6(f&#34;Sign-on Timestamp:&#34;),
                            html.H4(f&#34;{log_t_init.split(&#39;=&#39;)[1]}&#34;),
                            html.P(
                                f&#34;Current RUN ID:\t{RUN_ID}&#34;,
                                style={
                                    &#34;animation&#34;: &#34;anim-text-flow-keys 10s infinite linear&#34;,
                                    &#34;mixBlendMode&#34;: &#34;difference&#34;,
                                    &#34;fontSize&#34;: &#34;0.9rem&#34;,
                                },
                            ),
                        ],
                        className=&#34;updates-list&#34;,
                    ),
                    html.Summary(
                        html.Code(
                            f&#34;✔ LOGGED IN&#34;,
                            style={&#34;color&#34;: &#34;rgb(24, 230, 112)&#34;},
                            className=&#34;updates-header&#34;,
                        )
                    ),
                ],
                id=&#34;logged-in-status&#34;,
            )
        elif n_clicks &gt; 1 and prev_user != &#34;None yet..&#34; and enter_user != prev_user:
            return [
                html.Br(),
                html.H4(
                    f&#34;{putat_user}, would you like to sign on [&amp; log out {prev_user}]?&#34;,
                    style={&#34;display&#34;: &#34;block&#34;},
                ),
                html.P(f&#34;🧙🧠🗲⚛ 👌📓⬸📖🖊&#34;, style={&#34;fontSize&#34;: &#34;3rem&#34;}),
            ]

    except Exception as e:
        user_proper = &#34;⚠:[USER_UNKNOWN!]&#34;
        app.logger.warning(f&#34;Note: Exception raised during user sign on: {e}&#34;)

    return [
        html.Br(),
        html.H6(&#34;Sign In ( ⮩️🚪✨ ) to create a new, blank output directory for your analysis.&#34;),
    ]</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.display_generated_dd_output"><code class="name flex">
<span>def <span class="ident">display_generated_dd_output</span></span>(<span>dd1, dd2, submission, clear_submission, workflow, session_data, submission_timestamp)</span>
</code></dt>
<dd>
<div class="desc"><p>Generic template for a paired dynamics set of dropdowns;
such that the user selection in the first dropdown dynamically
modifies live the possible options in the second dropdown.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dd1</code></strong></dt>
<dd>str</dd>
<dt><strong><code>dd2</code></strong></dt>
<dd>str</dd>
<dt><strong><code>submission</code></strong></dt>
<dd>int</dd>
<dt><strong><code>clear_submission</code></strong></dt>
<dd>int</dd>
<dt><strong><code>workflow</code></strong></dt>
<dd>str</dd>
<dt><strong><code>session_data</code></strong></dt>
<dd>Dash.dcc.Store(type='session')</dd>
<dt><strong><code>submission_timestamp</code></strong></dt>
<dd>int</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(&#34;dd-selections&#34;, &#34;children&#34;),
    [
        Input(&#34;dd1-dropdown&#34;, &#34;value&#34;),
        Input(&#34;dd2-dropdown&#34;, &#34;value&#34;),
        Input(&#34;submit-dds&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;),
        Input(&#34;workflow-id&#34;, &#34;value&#34;),
    ],
    [State(&#34;session&#34;, &#34;data&#34;), State(&#34;submit-selected-dds&#34;, &#34;n_clicks_timestamp&#34;)],
)
def display_generated_dd_output(
    dd1,
    dd2,
    submission,
    clear_submission,
    workflow,
    session_data,
    submission_timestamp,
):
    &#34;&#34;&#34;Generic template for a paired dynamics set of dropdowns;
    such that the user selection in the first dropdown dynamically
    modifies live the possible options in the second dropdown.

    Args:
        dd1: str
        dd2: str
        submission: int
        clear_submission: int
        workflow: str
        session_data: Dash.dcc.Store(type=&#39;session&#39;)
        submission_timestamp: int
    &#34;&#34;&#34;

    if (dd1 == &#34;None&#34; and dd2 == &#34;None&#34;) or dd1 is None:
        return [
            html.Div(
                [
                    html.Span(
                        f&#34;Make a new selection.&#34;,
                        style={&#34;textAlign&#34;: &#34;center&#34;, &#34;fontFamily&#34;: &#34;Muli&#34;, &#34;fontSize&#34;: &#34;1.5rem&#34;},
                    ),
                    html.Span(
                        html.Img(
                            src=&#34;../assets/animations/dna-minimal-green.gif&#34;,
                            height=&#34;150&#34;,
                            style={
                                &#34;transform&#34;: &#34;translateY(-55px) translateX(5px)&#34;,
                                &#34;filter&#34;: &#34;hue-rotate(100deg) contrast(1.1) saturate(5)&#34;,
                                &#34;position&#34;: &#34;absolute&#34;,
                                &#34;opacity&#34;: &#34;0.5&#34;,
                                &#34;borderRadius&#34;: &#34;250px&#34;,
                            },
                        )
                    ),
                ],
                style={
                    &#34;marginLeft&#34;: &#34;25%&#34;,
                    &#34;position&#34;: &#34;relative&#34;,
                    &#34;textAlign&#34;: &#34;center&#34;,
                    &#34;width&#34;: &#34;50%&#34;,
                    &#34;zIndex&#34;: &#34;-1&#34;,
                },
            ),
            html.Div(
                [
                    html.Span(&#34;↪⦿&#34;),
                    html.Img(
                        src=&#34;../assets/images/scope-unic.png&#34;,
                        width=&#34;80&#34;,
                        style={&#34;marginTop&#34;: &#34;15px&#34;, &#34;marginBottom&#34;: &#34;-25px&#34;, &#34;cursor&#34;: &#34;pointer&#34;},
                    ),
                    html.Span(&#34;⥅♅&#34;),
                ],
                style={
                    &#34;textAlign&#34;: &#34;center&#34;,
                    &#34;fontSize&#34;: &#34;1.75rem&#34;,
                    &#34;animation&#34;: &#34;animateGlow 45s infinite linear!important&#34;,
                    &#34;cursor&#34;: &#34;pointer&#34;,
                },
            ),
        ]
    elif any(ui == &#34;Error&#34; for ui in [dd1, dd2]):
        return
    elif dd1 != &#34;None&#34; and dd2 is None:
        return [
            html.H5(
                f&#34;ℹ | Informational message to display.&#34;,
                style={&#34;textAlign&#34;: &#34;center&#34;, &#34;marginLeft&#34;: &#34;25%&#34;, &#34;width&#34;: &#34;50%&#34;},
            )
        ]
    elif all(ui != &#34;None&#34; for ui in [dd1, dd2]):

        return html.Div(
            [
                html.Code(
                    f&#34;♻ Cleared submission state: [total_clears={clear_submission}]&#34;,
                    style={&#34;fontStyle&#34;: &#34;italic&#34;, &#34;fontSize&#34;: &#34;0.9rem&#34;, &#34;marginBottom&#34;: &#34;5px&#34;},
                ),
                html.Br(),
                html.Div(
                    [
                        html.H6(
                            [
                                html.P(f&#34;⮊ Click ⬫Submit⬫ 𝑓𝗈𝓇⤑{dd2} ~ {dd1}&#34;),
                                html.Span(&#34;to initiate &#34;),
                                html.Span(
                                    f&#34;in silico &#34;,
                                    style={&#34;fontStyle&#34;: &#34;italic&#34;, &#34;fontFamily&#34;: &#34;&#39;Times&#39;, serif&#34;},
                                ),
                                html.Span(&#34;analysis of selections.&#34;),
                            ],
                            style={
                                &#34;textAlign&#34;: &#34;center&#34;,
                                &#34;cursor&#34;: &#34;pointer&#34;,
                                &#34;color&#34;: &#34;#ffffff6e&#34;,
                                &#34;backgroundImage&#34;: &#34;url(https://media.giphy.com/media/4HIOPSXOitJ2o/giphy.gif)&#34;,
                                &#34;mozBackgroundClip&#34;: &#34;text&#34;,
                                &#34;webkitBackgroundClip&#34;: &#34;text&#34;,
                                &#34;fontWeight&#34;: &#34;700&#34;,
                                &#34;backgroundSize&#34;: &#34;60%&#34;,
                            },
                        )
                    ],
                    style={
                        &#34;position&#34;: &#34;absolute&#34;,
                        &#34;margin&#34;: &#34;&#34;&#34;0.5% -5% -5% -5%&#34;&#34;&#34;,
                        &#34;textAlign&#34;: &#34;center&#34;,
                        &#34;display&#34;: &#34;inline-block&#34;,
                        &#34;mixBlendMode&#34;: &#34;lighten&#34;,
                        &#34;width&#34;: &#34;200px&#34;,
                    },
                ),
                html.Br(),
                html.Br(),
                html.Div(
                    [
                        html.Span(&#34;✂&#34;),
                        html.Span(&#34;۝&#34;),
                        html.Span(&#34;⭾&#34;),
                        html.Span(&#34;α/β&#34;),
                        html.Div(
                            [
                                html.Video(
                                    src=f&#34;data:video/mp4;base64,{base64.b64encode(open(f&#39;../assets/animations/T-Cell_TEM_4-3.mp4&#39;, &#39;rb&#39;).read()).decode()}&#34;,
                                    id=&#34;t-cell&#34;,
                                    autoPlay=True,
                                    loop=True,
                                    controls=False,
                                    preload=&#34;true&#34;,
                                    muted=True,
                                )
                            ],
                            style={&#34;filter&#34;: &#34;opacity(0.25)&#34;},
                        ),
                    ],
                    style={
                        &#34;textAlign&#34;: &#34;center&#34;,
                        &#34;fontSize&#34;: &#34;2rem&#34;,
                        &#34;width&#34;: &#34;20%&#34;,
                        &#34;marginLeft&#34;: &#34;40.5%&#34;,
                        &#34;mixBlendMode&#34;: &#34;exclusion&#34;,
                    },
                    className=&#34;animate twirl&#34;,
                ),
            ],
            style={&#34;textAlign&#34;: &#34;center&#34;},
        )</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.download_all_selected"><code class="name flex">
<span>def <span class="ident">download_all_selected</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Send path from directory to allow user to
download zipped files as an attachment.</p>
<h2 id="returns">Returns</h2>
<p>File download directly to user's PC.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.server.endpoint(&#34;/downloadZAll&#34;)
def download_all_selected():
    &#34;&#34;&#34;Send path from directory to allow user to
    download zipped files as an attachment.

    Returns:
        File download directly to user&#39;s PC.
    &#34;&#34;&#34;
    value = flask.request.args.get(&#34;value&#34;)
    fbn = f&#34;{os.path.basename(value)}&#34;
    app.logger.info(f&#34;🗽| REQUEST TO DOWNLOAD: for [zipped] server file @ {value}&#34;)
    return flask.send_from_directory(
        directory=f&#34;{os.path.dirname(value)}&#34;,
        filename=fbn,
        attachment_filename=fbn,
        as_attachment=True,
        mimetype=&#34;zip&#34;,
    )</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.download_file"><code class="name flex">
<span>def <span class="ident">download_file</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Send path from directory to allow user
to download file as an attachment.</p>
<p>Returns:</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.server.endpoint(&#34;/urlToDownload&#34;)
def download_file():
    &#34;&#34;&#34;Send path from directory to allow user
       to download file as an attachment.

    Returns:
    &#34;&#34;&#34;
    value = flask.request.args.get(&#34;value&#34;)
    fbn = f&#34;{os.path.basename(value)}&#34;
    app.logger.info(f&#34;🗽| REQUEST TO DOWNLOAD: for server file @ {value}&#34;)
    mime = &#34;text/plain&#34; if &#34;png&#34; not in value else &#34;image/png&#34;
    return flask.send_from_directory(
        directory=f&#34;{os.path.dirname(value)}&#34;,
        filename=fbn,
        attachment_filename=fbn,
        as_attachment=True,
        mimetype=mime,
    )</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.enable_combined_file_uploads"><code class="name flex">
<span>def <span class="ident">enable_combined_file_uploads</span></span>(<span>append_nclicks, clear_nclicks, refresh_nclicks, list_of_contents, session_data, clientside_memory_cache, append_nclicks_timestamp, refresh_nclicks_timestamp, clear_nclicks_timestamp, list_of_names, list_of_dates)</span>
</code></dt>
<dd>
<div class="desc"><p>Management of app components and file upload States allowing for USER-
toggled continuation of upload (i.e., as opposed to overwriting any previously
received ABI files uploaded).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>append_nclicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>clear_nclicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>refresh_nclicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>list_of_contents</code></strong></dt>
<dd>list of bytes</dd>
<dt><strong><code>session_data</code></strong></dt>
<dd>Dash.dcc.Store(type='memory')</dd>
<dt><strong><code>clientside_memory_cache</code></strong></dt>
<dd>Dash.dcc.Store(type='memory')</dd>
<dt><strong><code>append_nclicks_timestamp</code></strong></dt>
<dd>int</dd>
<dt><strong><code>refresh_nclicks_timestamp</code></strong></dt>
<dd>int</dd>
<dt><strong><code>clear_nclicks_timestamp</code></strong></dt>
<dd>int</dd>
<dt><strong><code>list_of_names</code></strong></dt>
<dd>list of str</dd>
<dt><strong><code>list_of_dates</code></strong></dt>
<dd>list of int</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(&#34;memory&#34;, &#34;data&#34;),
    [
        Input(&#34;append-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;refresh-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;upload-data&#34;, &#34;contents&#34;),
    ],
    [
        State(&#34;session&#34;, &#34;data&#34;),
        State(&#34;memory&#34;, &#34;data&#34;),
        State(&#34;append-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;upload-data&#34;, &#34;filename&#34;),
        State(&#34;upload-data&#34;, &#34;last_modified&#34;),
    ],
)
def enable_combined_file_uploads(
    append_nclicks,
    clear_nclicks,
    refresh_nclicks,
    list_of_contents,
    session_data,
    clientside_memory_cache,
    append_nclicks_timestamp,
    refresh_nclicks_timestamp,
    clear_nclicks_timestamp,
    list_of_names,
    list_of_dates,
):
    &#34;&#34;&#34;Management of app components and file upload States allowing for USER-
    toggled continuation of upload (i.e., as opposed to overwriting any previously
    received ABI files uploaded).
    
    Args:
        append_nclicks: int
        clear_nclicks: int
        refresh_nclicks: int
        list_of_contents: list of bytes
        session_data: Dash.dcc.Store(type=&#39;memory&#39;)
        clientside_memory_cache: Dash.dcc.Store(type=&#39;memory&#39;)
        append_nclicks_timestamp: int
        refresh_nclicks_timestamp: int
        clear_nclicks_timestamp: int
        list_of_names: list of str
        list_of_dates: list of int
    &#34;&#34;&#34;
    memory_reset = {}
    if not session_data:
        raise PreventUpdate
    if clear_nclicks &gt; 0:
        t_elapse = tns() / 1e9 - clear_nclicks_timestamp / 1e3
        app.logger.info(f&#34;CLEAR UPLOAD UI ACTION DETECTED, W/ `t_elapse` = {t_elapse}&#34;)
        if t_elapse &lt; 2:
            return memory_reset
    if append_nclicks &gt; 0:
        LOG_FILE = session_data[&#34;session_log_file&#34;]
        RUN_ID = session_data[&#34;RUN_ID&#34;]
        SESSION_OUTPUT_DIR = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
        app.logger.info(f&#34;Append to Uploads in progress...&#34;)
        app.logger.info(f&#34; ...Adding the following files: \n{list_of_names}&#34;)
        memory_reset = {f&#34;{RUN_ID}-list_of_names&#34;: []}
        uploads_cache = clientside_memory_cache or memory_reset
        parsed_upload_children = [
            html.Details(
                [
                    parse_contents(c, n, d, SESSION_OUTPUT_DIR, session_log_file=LOG_FILE)
                    for c, n, d in zip(list_of_contents, list_of_names, list_of_dates)
                ]
            )
        ]
        uploads_cache[f&#34;{RUN_ID}-len_most_recent&#34;] = len(parsed_upload_children)
        uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;].extend(list_of_names)
        uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;] = list(
            set(uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;])
        )
        uploads_cache[f&#34;{RUN_ID}-len_of_contents&#34;] = len(uploads_cache[f&#34;{RUN_ID}-list_of_names&#34;])
        return uploads_cache
    else:
        return memory_reset</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.log_out_or_comeback"><code class="name flex">
<span>def <span class="ident">log_out_or_comeback</span></span>(<span>logout, quick_logback, log_out_timestamp, sign_on_timestamp, logback_on_timestamp, signon, user_profile)</span>
</code></dt>
<dd>
<div class="desc"><p>Enable USER "Log Out" functionality.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>logout</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks log out button</dd>
<dt><strong><code>quick_logback</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks "Return" button</dd>
<dt><strong><code>log_out_timestamp</code></strong> :&ensp;<code>int</code></dt>
<dd>Timestamp of last user click log out button</dd>
<dt><strong><code>sign_on_timestamp</code></strong> :&ensp;<code>int</code></dt>
<dd>Timestamp of last user click sign-in button</dd>
<dt><strong><code>logback_on_timestamp</code></strong> :&ensp;<code>int</code></dt>
<dd>Timestamp of last user click "Return" button</dd>
<dt><strong><code>signon</code></strong> :&ensp;<code>int</code></dt>
<dd>Total cumulative count of clicks user sign-in button</dd>
<dt><strong><code>user_profile</code></strong> :&ensp;<code>Dash.dcc.Store(type='local')</code></dt>
<dd>Browser-cached local app memory, containing stored saved
user "profile" info / stats.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;input-user-name&#34;, &#34;value&#34;),
    [
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;log-back-in-submit&#34;, &#34;n_clicks&#34;),
    ],
    [
        State(f&#34;log-out-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;log-back-in-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        State(f&#34;local&#34;, &#34;data&#34;),
    ],
)
def log_out_or_comeback(
    logout,
    quick_logback,
    log_out_timestamp,
    sign_on_timestamp,
    logback_on_timestamp,
    signon,
    user_profile,
):
    &#34;&#34;&#34;Enable USER &#34;Log Out&#34; functionality.

    Parameters
    ----------
    logout : int
        Total cumulative count of clicks log out button
    quick_logback : int
        Total cumulative count of clicks &#34;Return&#34; button
    log_out_timestamp : int
        Timestamp of last user click log out button
    sign_on_timestamp : int
        Timestamp of last user click sign-in button
    logback_on_timestamp : int
        Timestamp of last user click &#34;Return&#34; button
    signon : int
        Total cumulative count of clicks user sign-in button
    user_profile : Dash.dcc.Store(type=&#39;local&#39;)
        Browser-cached local app memory, containing stored saved
        user &#34;profile&#34; info / stats.
    &#34;&#34;&#34;
    if not user_profile:
        raise PreventUpdate
    if logout &lt; 1 and quick_logback &lt; 1:
        raise PreventUpdate
    if quick_logback &gt; 0:
        if signon &gt; 0 and logout &gt; 0:
            if logback_on_timestamp &gt; max(log_out_timestamp, sign_on_timestamp):
                return user_profile[&#34;userAccount&#34;]
        elif signon &lt; 1:
            return user_profile[&#34;userAccount&#34;]
    elif logout &gt; 0 and signon &gt; 0:
        if log_out_timestamp &gt; sign_on_timestamp:
            return &#34;None&#34;</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.record_user_name"><code class="name flex">
<span>def <span class="ident">record_user_name</span></span>(<span>login_n_clicks, logout_n_clicks, clear_pl_n_clicks, user_selection, data, local_cache, init_pl_n_clicks, initiate_pipeline_timestamp, clear_pipeline_timestamp, user_login_timestamp, refresh_uploads_timestamp, log_out_timestamp)</span>
</code></dt>
<dd>
<div class="desc"><p>Upon user sign on (or sign off), correspondingly update the cached
information describing the current user (e.g., name, proper name, sign
in history, etc.) and create and store a new RUN ID for the current
session, as applicable.</p>
<h2 id="args">Args</h2>
<p>login_n_clicks (int):
Total cumulative count of clicks user sign-in button
logout_n_clicks (int):
Total cumulative count of clicks log out button
clear_pl_n_clicks (int):
Total cumulative count of clicks clear results button
user_selection (str):
Selected value from user names dropdown in app log-in section
data (Dash.dcc.Store):
[Session] HTTP client-side memory cache
local_cache (Dash.dcc.Store):
[Local] HTTP client-side memory cache
init_pl_n_clicks (int):
Total cumulative count of clicks initiate step 2 pipeline button
initiate_pipeline_timestamp (int):
Timestamp of last user click initiate step 2 pipeline button
clear_pipeline_timestamp (int):
Timestamp of last user click clear results button
user_login_timestamp (int):
Timestamp of last user click sign-in button
refresh_uploads_timestamp (int):
Timestamp of last user click refresh uploads button
log_out_timestamp (int):
Timestamp of last user click log out button</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    [
        Output(f&#34;session&#34;, &#34;data&#34;),
        Output(f&#34;local&#34;, &#34;data&#34;),
    ],
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;log-out-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
    ],
    [
        State(f&#34;input-user-name&#34;, &#34;value&#34;),
        State(f&#34;session&#34;, &#34;data&#34;),
        State(f&#34;local&#34;, &#34;data&#34;),
        State(f&#34;initiate-pipeline&#34;, &#34;n_clicks&#34;),
        State(f&#34;initiate-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;clear-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(f&#34;log-out-submit&#34;, &#34;n_clicks_timestamp&#34;),
    ],
)
def record_user_name(
    login_n_clicks,
    logout_n_clicks,
    clear_pl_n_clicks,
    user_selection,
    data,
    local_cache,
    init_pl_n_clicks,
    initiate_pipeline_timestamp,
    clear_pipeline_timestamp,
    user_login_timestamp,
    refresh_uploads_timestamp,
    log_out_timestamp,
):
    &#34;&#34;&#34;Upon user sign on (or sign off), correspondingly update the cached
    information describing the current user (e.g., name, proper name, sign
    in history, etc.) and create and store a new RUN ID for the current
    session, as applicable.

    Args:
        login_n_clicks (int):
            Total cumulative count of clicks user sign-in button
        logout_n_clicks (int):
            Total cumulative count of clicks log out button
        clear_pl_n_clicks (int):
            Total cumulative count of clicks clear results button
        user_selection (str):
            Selected value from user names dropdown in app log-in section
        data (Dash.dcc.Store):
            [Session] HTTP client-side memory cache
        local_cache (Dash.dcc.Store):
            [Local] HTTP client-side memory cache
        init_pl_n_clicks (int):
            Total cumulative count of clicks initiate step 2 pipeline button
        initiate_pipeline_timestamp (int):
            Timestamp of last user click initiate step 2 pipeline button
        clear_pipeline_timestamp (int):
            Timestamp of last user click clear results button
        user_login_timestamp (int):
            Timestamp of last user click sign-in button
        refresh_uploads_timestamp (int):
            Timestamp of last user click refresh uploads button
        log_out_timestamp (int):
            Timestamp of last user click log out button
    &#34;&#34;&#34;
    app.logger.debug(f&#34;sign on timestamp: {user_login_timestamp}&#34;)
    reset_session_data = {
        &#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;,
        &#34;RUN_ID&#34;: &#34;NA&#34;,
        &#34;current_user&#34;: &#34;None&#34;,
        &#34;user_logged_in&#34;: &#34;False&#34;,
        &#34;user_proper&#34;: &#34;NA&#34;,
    }
    if login_n_clicks &lt; 1 or user_selection == &#34;None&#34; or not user_selection:
        if not user_selection:
            return (
                reset_session_data,
                local_cache,
            )
        else:
            data = {&#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;}
            data[&#34;RUN_ID&#34;] = &#34;NA&#34;
            data[&#34;current_user&#34;] = user_selection
            data[&#34;login n_clicks&#34;] = login_n_clicks
            data[&#34;user_logged_in&#34;] = &#34;False&#34;
            data[&#34;user_proper&#34;] = user_selection.replace(&#34;_&#34;, &#34; &#34;).title().split()[0]
            return data, local_cache

    login_t_elapse = tns() / 1e9 - user_login_timestamp / 1e3
    UUID = f&#34;{&#39;&#39;.join([*map(lambda x: x[:2], user_selection.split(&#39;_&#39;))])}&#34;
    logins = f&#34;SIGN_ON-№{login_n_clicks}&#34;
    data = data or {&#34;SIGN_ON-№0&#34;: &#34;None yet..&#34;}
    data[&#34;UUID&#34;] = UUID
    user_proper = user_selection[0] + user_selection.split(&#34;_&#34;)[0].lower()[1:]
    data[&#34;user_proper&#34;] = user_proper
    data[&#34;current_user&#34;] = user_selection
    data[&#34;login n_clicks&#34;] = login_n_clicks

    if (login_n_clicks &gt; logout_n_clicks and user_selection != &#34;None&#34;) and login_t_elapse &lt; 2:
        data[&#34;user_logged_in&#34;] = &#34;True&#34;

    if logout_n_clicks &gt; 0:
        if (tns() / 1e9 - log_out_timestamp / 1e3) &lt; 2:
            return reset_session_data, local_cache

    if not user_selection:
        data[&#34;user_logged_in&#34;] = &#34;None&#34;
        return data, local_cache

    # Proceed with apparent sign-in submission if this point reached:
    login_t_init = f&#34;{tns()} = {now()}&#34;
    data[&#34;login_t_init&#34;] = login_t_init
    data[logins] = user_selection
    if &#34;SIGN_ON-№1&#34; in data.keys():
        data[&#34;prev_user&#34;] = data[f&#34;SIGN_ON-№{max(login_n_clicks-1,1)}&#34;]

    RUN_ID = f&#34;APP_RUNID_{now()}&#34;
    SESSION_OUTPUT_DIR = f&#34;{RUN_OUTPUT_DIR}/{today()}/{RUN_ID}/&#34;
    data[&#34;RUN_ID&#34;] = RUN_ID
    data[&#34;PATH_TO_SESSION_OUTPUT&#34;] = SESSION_OUTPUT_DIR

    session_log_file = f&#34;{SESSION_OUTPUT_DIR}{RUN_ID}_CurrentSession.log&#34;
    os.makedirs(SESSION_OUTPUT_DIR, exist_ok=True)
    app.logger.debug(f&#34;Number of logger handlers: {logger.handlers}&#34;)
    fh = add_logfile(logfile=session_log_file, logger=logger)
    app.logger.addHandler(fh)
    app.logger.debug(f&#34;Number of logger handlers: {logger.handlers}&#34;)

    app.logger.info(f&#34;USER SIGN ON @ {login_t_init}&#34;)
    app.logger.info(f&#34;*** CURRENT APP APP SOFTWARE VERSION = {VERSION} ***&#34;)
    data[&#34;session_log_file&#34;] = session_log_file
    data[&#34;SESSION_DATA&#34;] = pd.DataFrame(
        [[RUN_ID, SESSION_OUTPUT_DIR, user_selection, session_log_file]],
        columns=[&#34;RUN_ID&#34;, &#34;PATH_TO_SESSION_OUTPUT&#34;, &#34;USER_ID&#34;, &#34;LOG_FILE&#34;],
    ).to_json(date_format=&#34;iso&#34;, orient=&#34;split&#34;)
    app.logger.info(f&#34;USER: &#39;{user_selection}&#39; | RUN ID: {RUN_ID}&#34;)

    # Store basic user profile in browser local cache for  app:
    reset_local_cache = {
        &#34;userName&#34;: user_proper,
        &#34;userAccount&#34;: user_selection,
        &#34;userProfileCreated&#34;: now(),
        &#34;countUserLogIns&#34;: 0,
        &#34;userRuns&#34;: {RUN_ID: data},
    }
    try:
        if local_cache[&#34;userAccount&#34;] != user_selection:
            local_cache = reset_local_cache
        local_cache[&#34;countUserLogIns&#34;] += 1
        local_cache[&#34;userRuns&#34;][RUN_ID] = data
    except Exception as e:
        app.logger.info(
            f&#34;Creating {user_proper}&#39;s first local memory cache! (I.e., by which to remember them by! 😉)&#34;
        )
        local_cache = reset_local_cache
        local_cache[&#34;countUserLogIns&#34;] += 1

    return data, local_cache</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.show_pipeline_commands"><code class="name flex">
<span>def <span class="ident">show_pipeline_commands</span></span>(<span>show_pl_cmds_n_clicks, style)</span>
</code></dt>
<dd>
<div class="desc"><p>Enable dynamic reveal/hide functionality for showing
the technical-heavy exact command line commands called
during the pipeline execution of processes.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>show_pl_cmds_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>style</code></strong></dt>
<dd><type></dd>
</dl>
<h2 id="returns">Returns</h2>
<p><type></p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>PreventUpdate</code></dt>
<dd>Description</dd>
</dl>
<p>PreventUpdate</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;cmds-dt-{n}&#34;, &#34;style&#34;),
    [Input(f&#34;show-cmds-{n}&#34;, &#34;n_clicks&#34;)],
    [State(f&#34;cmds-dt-{n}&#34;, &#34;style&#34;)],
)
def show_pipeline_commands(show_pl_cmds_n_clicks, style):
    &#34;&#34;&#34;Enable dynamic reveal/hide functionality for showing
    the technical-heavy exact command line commands called 
    during the pipeline execution of processes.
    
    Args:
        show_pl_cmds_n_clicks: int
        style: &lt;type&gt;
    
    Returns:
        &lt;type&gt;
    
    Raises:
        PreventUpdate: Description
        PreventUpdate
    &#34;&#34;&#34;
    if show_pl_cmds_n_clicks &gt; 0:
        if (show_pl_cmds_n_clicks % 2) == 1:
            app.logger.info(f&#34;show_pl_cmds clicked: {show_pl_cmds_n_clicks % 2}&#34;)
            return {&#34;display&#34;: &#34;block&#34;}
        else:
            return {&#34;display&#34;: &#34;none&#34;}
    else:
        raise PreventUpdate</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.show_user_in_menubar"><code class="name flex">
<span>def <span class="ident">show_user_in_menubar</span></span>(<span>sign_on_n_clicks, save_results_n_clicks, session_data, selected_username, local_data_cache)</span>
</code></dt>
<dd>
<div class="desc"><h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>sign_on_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>save_results_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>session_data</code></strong></dt>
<dd>Dash.dcc.Store(type='session')</dd>
<dt><strong><code>selected_username</code></strong></dt>
<dd>str</dd>
<dt><strong><code>local_data_cache</code></strong></dt>
<dd>Dash.dcc.Store(type='local')</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;user-status&#34;, &#34;children&#34;),
    [
        Input(f&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(f&#34;refresh-user-history&#34;, &#34;n_clicks&#34;),
        Input(f&#34;session&#34;, &#34;data&#34;),
    ],
    [State(f&#34;input-user-name&#34;, &#34;value&#34;), State(f&#34;local&#34;, &#34;data&#34;)],
)
def show_user_in_menubar(
    sign_on_n_clicks, save_results_n_clicks, session_data, selected_username, local_data_cache
):
    &#34;&#34;&#34;
    Parameters
    ----------
    sign_on_n_clicks
        int
    save_results_n_clicks
        int
    session_data
        Dash.dcc.Store(type=&#39;session&#39;)
    selected_username
        str
    local_data_cache
        Dash.dcc.Store(type=&#39;local&#39;)
    &#34;&#34;&#34;
    log_in = [
        html.Span(
            html.A([&#34;⁂ Sign In&#34;], href=f&#34;#log-in-below&#34;),
            style={&#34;fontSize&#34;: &#34;80%&#34;, &#34;color&#34;: &#34;goldenrod&#34;},
            id=f&#34;log-in&#34;,
        )
    ]
    if session_data and sign_on_n_clicks &gt; 0:
        if &#34;session_log_file&#34; in session_data:
            if session_data[&#34;current_user&#34;] != &#34;None&#34;:
                user = session_data[&#34;user_proper&#34;]
                USER = session_data[&#34;current_user&#34;]

                default = []
                history = {}
                try:
                    history = local_data_cache[f&#34;{USER}_APP_Saved_History&#34;]
                    app.logger.debug(str(local_data_cache), str(history))
                except Exception as e:
                    history = {}
                    default = [html.Li(f&#34;You have no saved APP Results History, yet!\n&#34;)]
                return [
                    html.Details(
                        [
                            html.Summary(
                                [
                                    html.Span(
                                        f&#34;👤Signed in as: {user}&#34;,
                                        style={
                                            &#34;fontFamily&#34;: &#34;Muli&#34;,
                                            &#34;fontSize&#34;: &#34;85%&#34;,
                                            &#34;cursor&#34;: &#34;pointer&#34;,
                                        },
                                        className=&#34;user-menu-summary&#34;,
                                    )
                                ]
                            ),
                            html.Div(
                                [
                                    html.Ul(
                                        [
                                            html.Li(f&#34;Current RUN_ID: {session_data[&#39;RUN_ID&#39;]}&#34;),
                                            html.Li(
                                                f&#34;User Is Logged In: {session_data[&#39;user_logged_in&#39;]}&#34;,
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(37, 109, 210)&#34;},
                                            ),
                                            html.Li(
                                                f&#34;Signed On @ {session_data[&#39;login_t_init&#39;]}&#34;,
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(17, 199, 210)&#34;},
                                            ),
                                            html.Li(
                                                [
                                                    html.A(
                                                        &#34;Your Saved Analysis History&#34;,
                                                        href=&#34;#save-user-results&#34;,
                                                    ),
                                                    html.Ul(
                                                        [
                                                            html.Li(dcc.Link(f&#34;{k}&#34;, href=f&#34;/{k}&#34;))
                                                            for k in history.keys()
                                                        ]
                                                        + default,
                                                        style={
                                                            &#34;listStyle&#34;: &#34;decimal-leading-zero&#34;,
                                                            &#34;margin&#34;: &#34;0!important&#34;,
                                                            &#34;padding&#34;: &#34;0!important&#34;,
                                                        },
                                                    ),
                                                ],
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(37, 149, 180)&#34;},
                                            ),
                                            html.Li(
                                                [
                                                    html.A(
                                                        &#34;Report an Issue/Bug&#34;,
                                                        href=&#34;mailto:jcollins.bioinformatics@gmail.com&#34;,
                                                    )
                                                ],
                                                className=&#34;user-menu-action-items&#34;,
                                                style={&#34;color&#34;: &#34;rgb(7, 69, 180)&#34;},
                                            ),
                                        ]
                                    )
                                ],
                                className=&#34;user-menu&#34;,
                                style={&#34;color&#34;: &#34;rgb(199, 199, 199)&#34;},
                            ),
                        ]
                    )
                ]
    return log_in</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.trigger_dropdowns"><code class="name flex">
<span>def <span class="ident">trigger_dropdowns</span></span>(<span>submit_n_clicks, clear_n_clicks, dd1, dd2)</span>
</code></dt>
<dd>
<div class="desc"><p>Initiate first analysis</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>submit_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>clear_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>dd1</code></strong></dt>
<dd>str</dd>
<dt><strong><code>dd2</code></strong></dt>
<dd>str</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Dash html component(s)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(&#34;submission-status&#34;, &#34;children&#34;),
    [Input(&#34;submit-selected-dds&#34;, &#34;n_clicks&#34;), Input(&#34;clear-dd-selections&#34;, &#34;n_clicks&#34;)],
    [State(&#34;dd1-dropdown&#34;, &#34;value&#34;), State(&#34;dd2-dropdown&#34;, &#34;value&#34;)],
)
def trigger_dropdowns(submit_n_clicks, clear_n_clicks, dd1, dd2):
    &#34;&#34;&#34;Initiate first analysis

    Args:
        submit_n_clicks: int
        clear_n_clicks: int
        dd1: str
        dd2: str

    Returns:
        Dash html component(s)
    &#34;&#34;&#34;
    if clear_n_clicks == submit_n_clicks + 1:
        return html.Code(
            &#34;⚠ | ℹ Overclicking clear *may* require compensatory submits! (I.e., Try clicking submit button &gt;1 times, if submissions are not going through.)&#34;,
            style={
                &#34;color&#34;: &#34;red&#34;,
                &#34;display&#34;: &#34;flex&#34;,
                &#34;flexFlow&#34;: &#34;column wrap&#34;,
                &#34;fontSize&#34;: &#34;1.0rem&#34;,
                &#34;margin&#34;: &#34;0px 30% 20px 30%&#34;,
            },
        )
    if all(ui not in (&#34;None&#34;, None) for ui in [dd1, dd2]):
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;trigger_dropdowns&#39;) has been activated, and now has value &#39;submit_n_clicks&#39; = {submit_n_clicks}&#34;
        )
        return [html.Code(f&#34;SUBMISSION for: {dd1}, @Well{dd2}&#34;)]
    elif clear_n_clicks &gt; submit_n_clicks + 1:
        app.logger.info(
            f&#34;-:!:- FUNCTION(&#39;trigger_dropdowns&#39;) has been cleared, and now has value &#39;clear_n_clicks&#39; = {clear_n_clicks}&#34;
        )
        return html.Code(
            f&#34;Submissions cleared: {clear_n_clicks}, [submissions_count={submit_n_clicks}].&#34;,
            style={&#34;fontStyle&#34;: &#34;normal&#34;, &#34;color&#34;: &#34;gray&#34;, &#34;margin&#34;: &#34;0px 30% 20px 30%&#34;},
        )
    else:
        return html.Code(&#34;No submissions received, it seems...&#34;)</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.update_dropdown"><code class="name flex">
<span>def <span class="ident">update_dropdown</span></span>(<span>dd1)</span>
</code></dt>
<dd>
<div class="desc"><p>Update Dropdown for sample corresponding to USER-selected ID.</p>
<h2 id="args">Args</h2>
<p>dd1 (Array of "label":"value" pairs dictionary containing the): Dropdown's options.</p>
<h2 id="returns">Returns</h2>
<p>Updated array matching form of input.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(Output(&#34;dd2-dropdown&#34;, &#34;options&#34;), [Input(&#34;dd1-dropdown&#34;, &#34;value&#34;)])
def update_dropdown(dd1):
    &#34;&#34;&#34;Update Dropdown for sample corresponding to USER-selected ID.
    
    Args:
        dd1 (Array of &#34;label&#34;:&#34;value&#34; pairs dictionary containing the): Dropdown&#39;s options.
    
    Returns:
        Updated array matching form of input.
    &#34;&#34;&#34;
    app.logger.debug(f&#34;CALLBACK:::`update_dropdown` triggered with value: {dd1}&#34;)
    if dd1 and dd1 != &#34;None&#34;:
        ent_id, ent_name, = dd1.split(&#34;-&#34;)
        try:
            wells = entity_schemas.loc[ent_name].columns #.unique()
        except KeyError as e:
            app.logger.info(f&#34;WellID dropdown error in Plasmid Tool:\n{e}&#34;)
            return [{&#34;label&#34;: &#34;——N/A——&#34;, &#34;value&#34;: &#34;Error&#34;}]
        # ⤑⟗αβ⟗⇒ *Trigger Ligation*
        return [{&#34;label&#34;: &#34; ✔ Confirm Well &amp; EXP ID&#34;, &#34;value&#34;: &#34;None&#34;}] + [
            {&#34;label&#34;: w, &#34;value&#34;: w}
            for w in wells
        ]
    else:
        return [{&#34;label&#34;: &#34;——N/A——&#34;, &#34;value&#34;: &#34;None&#34;}]</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.update_link"><code class="name flex">
<span>def <span class="ident">update_link</span></span>(<span>refresh_n_clicks, value, session_data)</span>
</code></dt>
<dd>
<div class="desc"><p>"Download Output Files" dropdown components suite.</p>
<p>Allows user to choose from a list of file 'genres' (i.e.,
subsets of similar bioinformatics datafile types) - and
reacts by displaying all corresponding generated results
files for the current session analysis up-to-now, which
dual, and principally serve their purpose, as direct-to-
desktop functional download links.</p>
<p>Also capable of showing a full printout of the current cum-
ulative state of the session logfile in via an HTML
textarea Dash component.</p>
<p>Finally, users are also presented (via HTML button comp)
the option and ability to create a click-to-download link
for a dynamically generated zipped archive of all curr-
ently selected (&amp; thus [reactively] displayed) results
files.</p>
<h2 id="args">Args:</h2>
<pre><code>refresh_n_clicks           :  int
value                      :  str
session_data (dcc.Store(   :  Dash HTTP client-side memory caching,
    type='session')        . "Session" type (auto-cleared when browser
              )            .  tab closes [but *not* on Refresh's]).
</code></pre>
<h2 id="returns">Returns:</h2>
<pre><code>html.Div([html.Li's])      :  An array of download-enabling Dash HTML
                              hyperlink components.
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;output-file-list&#34;, &#34;children&#34;),
    [Input(f&#34;refresh-downloads-links&#34;, &#34;n_clicks&#34;)],
    [State(f&#34;download-dropdown&#34;, &#34;value&#34;), State(f&#34;session&#34;, &#34;data&#34;)],
)
def update_link(refresh_n_clicks, value, session_data):
    &#34;&#34;&#34;&#34;Download Output Files&#34; dropdown components suite.

    Allows user to choose from a list of file &#39;genres&#39; (i.e.,
    subsets of similar bioinformatics datafile types) - and
    reacts by displaying all corresponding generated results
    files for the current session analysis up-to-now, which
    dual, and principally serve their purpose, as direct-to-
    desktop functional download links.

    Also capable of showing a full printout of the current cum-
    ulative state of the session logfile in via an HTML
    textarea Dash component.

    Finally, users are also presented (via HTML button comp)
    the option and ability to create a click-to-download link
    for a dynamically generated zipped archive of all curr-
    ently selected (&amp; thus [reactively] displayed) results
    files.

    Args:
    -----
        refresh_n_clicks           :  int
        value                      :  str
        session_data (dcc.Store(   :  Dash HTTP client-side memory caching,
            type=&#39;session&#39;)        . &#34;Session&#34; type (auto-cleared when browser
                      )            .  tab closes [but *not* on Refresh&#39;s]).

    Returns:
    --------
        html.Div([html.Li&#39;s])      :  An array of download-enabling Dash HTML
                                      hyperlink components.

    &#34;&#34;&#34;
    if value:
        if session_data:
            selection = output_filetype_genres[value]
            try:
                session_output = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
            except KeyError as e:
                app.logger.info(
                    f&#34;User attempting to access files when not yet logged in!\nError:\n{e}&#34;
                )
                return [html.Li(f&#34;(Please log in first!)&#34;)]
            if value == &#34;LOGS&#34;:
                files = sorted(get_output_files(selection, session_output))
                logs = []
                for f in files:
                    with open(f, &#34;r+&#34;) as log_file:
                        for line in log_file.readlines():
                            logs.append(line)
                    if len(app.logger.handlers) &lt; 1:
                        app.logger.addHandler(add_logfile(f))
                        app.logger.info(&#34;Re-added logfile (post-log printout)&#34;)
                return [html.Li(file_download_link(filename)) for filename in files] + [
                    dcc.Textarea(
                        placeholder=&#34;(No logged activity yet.)&#34;,
                        value=&#34;\n&#34;.join(logs),
                        style={
                            &#34;height&#34;: &#34;550px&#34;,
                            &#34;width&#34;: &#34;60%&#34;,
                            &#34;fontSize&#34;: &#34;0.7rem&#34;,
                            &#34;lineHeight&#34;: &#34;0.9rem&#34;,
                            &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                        },
                        className=&#34;logger-text&#34;,
                        name=&#34;organization&#34;,
                        readOnly=True,
                    )
                ]
            elif value == &#34;REF&#34;:
                return [
                    html.Li(
                        file_download_link(filename),
                        style={&#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;, &#34;letterSpacing&#34;: &#34;-1pt&#34;},
                    )
                    for filename in sorted(get_output_files(selection))
                ]
            files = get_output_files(selection, session_output)
            if len(files) == 0:
                return [html.Li(f&#34;No output files available for selection: {value}.&#34;)]
            else:
                return [
                    html.Li(
                        file_download_link(filename),
                        style={&#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;, &#34;letterSpacing&#34;: &#34;-1pt&#34;},
                    )
                    for filename in sorted(files)
                ]
        else:
            return [html.Li(f&#34;(Please log in first!)&#34;)]
    else:
        return [html.Li(f&#34;[Select an output filetype(s) category.]&#34;)]</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.update_output"><code class="name flex">
<span>def <span class="ident">update_output</span></span>(<span>list_of_contents, list_of_names, list_of_dates, initiate_pipeline_n_clicks, clear_pipeline_n_clicks, append_uploads_n_clicks, refresh_uploads_n_clicks, clear_uploads_n_clicks, memory, user_login_n_clicks, session_data, workflow, initiate_pipeline_timestamp, clear_pipeline_timestamp, user_login_timestamp, refresh_uploads_timestamp, clear_uploads_timestamp)</span>
</code></dt>
<dd>
<div class="desc"><p>Primary APP Pipeline function, as triggered by 'Initiate
[APP] Pipeline' UI button (located in the "Step 2 (2/2)"
section).</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>list_of_contents</code></strong></dt>
<dd><list of str>
Array containing user-uploaded ABI raw contents as
binary strings (thus requiring decoding)</dd>
<dt><strong><code>list_of_names</code></strong></dt>
<dd><list of str>
Array containing user-uploaded ABI filenames
(does not include the full path for security reasons)</dd>
<dt><strong><code>list_of_dates</code></strong></dt>
<dd><list of int>
Array containing user-uploaded ABI last modified timestamps
(integers as seconds since 1970)</dd>
<dt><strong><code>initiate_pipeline_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>clear_pipeline_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>append_uploads_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>refresh_uploads_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>clear_uploads_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>memory</code></strong></dt>
<dd>Dash.dcc.Store(type='session')</dd>
<dt><strong><code>user_login_n_clicks</code></strong></dt>
<dd><int>
Total count of UI button clicks</dd>
<dt><strong><code>session_data</code></strong></dt>
<dd>Dash.dcc.Store(type='session')</dd>
<dt><strong><code>workflow</code></strong></dt>
<dd><type></dd>
<dt><strong><code>initiate_pipeline_timestamp</code></strong></dt>
<dd><type></dd>
<dt><strong><code>clear_pipeline_timestamp</code></strong></dt>
<dd><type></dd>
<dt><strong><code>user_login_timestamp</code></strong></dt>
<dd><type></dd>
<dt><strong><code>refresh_uploads_timestamp</code></strong></dt>
<dd><type></dd>
<dt><strong><code>clear_uploads_timestamp</code></strong></dt>
<dd><type></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(&#34;output-data-upload&#34;, &#34;children&#34;),
    [
        Input(&#34;upload-data&#34;, &#34;contents&#34;),
        Input(&#34;upload-data&#34;, &#34;filename&#34;),
        Input(&#34;upload-data&#34;, &#34;last_modified&#34;),
        Input(&#34;initiate-pipeline&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-pipeline&#34;, &#34;n_clicks&#34;),
        Input(&#34;append-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;refresh-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;clear-uploads&#34;, &#34;n_clicks&#34;),
        Input(&#34;memory&#34;, &#34;data&#34;),
        Input(&#34;sign-on-submit&#34;, &#34;n_clicks&#34;),
        Input(&#34;session&#34;, &#34;data&#34;),
    ],
    [
        State(&#34;workflow-id&#34;, &#34;value&#34;),
        State(&#34;initiate-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-pipeline&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;sign-on-submit&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;refresh-uploads&#34;, &#34;n_clicks_timestamp&#34;),
        State(&#34;clear-uploads&#34;, &#34;n_clicks_timestamp&#34;),
    ],
)
def update_output(
    list_of_contents,
    list_of_names,
    list_of_dates,
    initiate_pipeline_n_clicks,
    clear_pipeline_n_clicks,
    append_uploads_n_clicks,
    refresh_uploads_n_clicks,
    clear_uploads_n_clicks,
    memory,
    user_login_n_clicks,
    session_data,
    workflow,
    initiate_pipeline_timestamp,
    clear_pipeline_timestamp,
    user_login_timestamp,
    refresh_uploads_timestamp,
    clear_uploads_timestamp,
):
    &#34;&#34;&#34;Primary APP Pipeline function, as triggered by &#39;Initiate
    [APP] Pipeline&#39; UI button (located in the &#34;Step 2 (2/2)&#34;
    section).
    
    Parameters
    ----------
    list_of_contents
        &lt;list of str&gt;
        Array containing user-uploaded ABI raw contents as
        binary strings (thus requiring decoding)
    list_of_names
        &lt;list of str&gt;
        Array containing user-uploaded ABI filenames
        (does not include the full path for security reasons)
    list_of_dates
        &lt;list of int&gt;
        Array containing user-uploaded ABI last modified timestamps
        (integers as seconds since 1970)
    initiate_pipeline_n_clicks
        &lt;int&gt;
        Total count of UI button clicks
    clear_pipeline_n_clicks
        &lt;int&gt;
        Total count of UI button clicks
    append_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    refresh_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    clear_uploads_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    memory
        Dash.dcc.Store(type=&#39;session&#39;)
    user_login_n_clicks
        &lt;int&gt; 
        Total count of UI button clicks
    session_data
        Dash.dcc.Store(type=&#39;session&#39;)
    workflow
        &lt;type&gt;
    initiate_pipeline_timestamp
        &lt;type&gt;
    clear_pipeline_timestamp
        &lt;type&gt;
    user_login_timestamp
        &lt;type&gt;
    refresh_uploads_timestamp
        &lt;type&gt;
    clear_uploads_timestamp
        &lt;type&gt;
    
    &#34;&#34;&#34;

    def show_list_of_names(USER, list_of_names):
        &#34;&#34;&#34;Display the filenames for all successfully received 
        USER-uploaded ABI files.
        
        Args:
            USER: &lt;str&gt;
                Active user
            list_of_names: &lt;list&gt; 
                List of user-uploaded ABI filenames
        
        Returns:
            &lt;html.Div([...])&gt; 
                Reactive response to display after processing upload
        &#34;&#34;&#34;
        if not all([fn.endswith(tuple([&#34;.csv&#34;,&#34;.xlsx&#34;])) for fn in list_of_names]):
            return html.Div(
                [
                    html.Br(),
                    html.Code(
                        f&#34;⚠ UPLOAD ERROR: Not all of the {len(list_of_names)} files are CSV or Excel files !&#34;,
                        style={&#34;color&#34;: &#34;red&#34;},
                    ),
                    html.Br(),
                    html.Code(
                        f&#34;⛔ | Please reset this upload &amp; then perform a fresh upload of either .csv or .xlsx files.&#34;
                    ),
                ]
            )
        return html.Div(
            [
                html.Br(),
                html.Code(
                    f&#34;✔ UPLOAD SUCCESSFUL (N={len(list_of_names)})&#34;, style={&#34;color&#34;: &#34;green&#34;}
                ),
                html.Br(),
                html.Br(),
                html.Details(
                    [
                        html.Summary(
                            html.H3(
                                f&#34;File(s) received (click to expand)&#34;,
                                style={&#34;textAlign&#34;: &#34;left&#34;, &#34;fontSize&#34;: &#34;120%&#34;},
                            )
                        ),
                        html.Div(
                            [
                                html.Li(f&#34;{&#39;{:02d}&#39;.format(i+1)})\t{abi}&#34;)
                                for (i, abi) in enumerate(sorted(list_of_names))
                            ],
                            id=&#34;files-received&#34;,
                            style={
                                &#34;textAlign&#34;: &#34;left&#34;,
                                &#34;fontSize&#34;: &#34;60%&#34;,
                                &#34;columnCount&#34;: &#34;3&#34;,
                                &#34;paddingBottom&#34;: &#34;2%&#34;,
                                &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                            },
                        ),
                        html.Hr(
                            style={
                                &#34;borderTop&#34;: &#34;1px solid&#34;,
                                &#34;animation&#34;: &#34;pact-gradient-text-flow 3s infinite linear&#34;,
                                &#34;borderRadius&#34;: &#34;5px&#34;,
                                &#34;opacity&#34;: &#34;0.67&#34;,
                                &#34;width&#34;: &#34;50%&#34;,
                                &#34;marginLeft&#34;: &#34;25%&#34;,
                            }
                        ),
                    ]
                ),
                html.Br(),
                html.Span(className=&#34;fader-line-short&#34;, style={&#34;marginBottom&#34;: &#34;20px&#34;}),
            ],
            style={&#34;width&#34;: &#34;80%&#34;, &#34;marginLeft&#34;: &#34;10%&#34;},
        )

    not_signed_in_msg = html.Div(
        [html.H6(&#34;Please log in to release the pipeline as ready for activation.&#34;)]
    )

    try:
        if session_data:  # [&#34;user_logged_in&#34;] == &#34;True&#34;:
            RUN_ID = session_data[&#34;RUN_ID&#34;]
            SESSION_OUTPUT_DIR = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
            LOG_FILE = session_data[&#34;session_log_file&#34;]
            USER = session_data[&#34;user_proper&#34;]
            UUID = session_data[&#34;UUID&#34;]

            if len(app.logger.handlers) &lt; 1:
                app.logger.info(
                    f&#34;Number logger handlers = {len(app.logger.handlers)}-&gt;{logger.handlers}&#34;
                )
                app.logger.info(&#34;Adding log FileHandler...&#34;)
                fh = logging.FileHandler(LOG_FILE)
                fh.setLevel(logging.INFO)
                app.logger.addHandler(fh)
                app.logger.info(
                    f&#34;Number logger handlers = {len(app.logger.handlers)}-&gt;{logger.handlers}&#34;
                )
        else:
            return not_signed_in_msg

    except KeyError as e:
        app.logger.error(f&#34;No user appears to be logged in (KeyError: {e})&#34;)
        return not_signed_in_msg

    ### UPON USER FILE UPLOAD(S):
    if list_of_contents is not None:

        if initiate_pipeline_n_clicks &gt;= 1:
            init_t_elapse = tns() / 1e9 - initiate_pipeline_timestamp / 1e3
            app.logger.info(f&#34;init_t_elapse = {init_t_elapse}; &#34;)
            if init_t_elapse &lt; 30:
                if (
                    clear_pipeline_n_clicks &gt; 0
                    and refresh_uploads_n_clicks &lt;= clear_pipeline_n_clicks
                ):
                    if all(
                        clear_pipeline_timestamp &gt; ts
                        for ts in [initiate_pipeline_timestamp, user_login_timestamp]
                    ):
                        return [
                            html.H3(
                                f&#34;Thanks, {USER}; the previous pipeline results have been cleared.&#34;
                            ),
                            html.H4(f&#34;Current analysis output folder: {RUN_ID}&#34;),
                            html.H5(
                                html.Div(
                                    [
                                        html.Span(f&#34;Launch a new analysis.&#34;),
                                        html.Br(),
                                    ]
                                )
                            ),
                        ]
                elif clear_pipeline_n_clicks &gt; 0:
                    if clear_pipeline_timestamp &gt; initiate_pipeline_timestamp:
                        if refresh_uploads_n_clicks &gt; 0:
                            if refresh_uploads_timestamp &gt; clear_pipeline_timestamp:
                                return show_list_of_names(USER, list_of_names)
                        return html.Div(
                            html.H5(
                                f&#34;(Pipeline results [{RUN_ID}] CLEARED)&#34;, style={&#34;color&#34;: &#34;red&#34;}
                            )
                        )

                app.logger.info(
                    f&#34;📟📶⌁⌁⌁📠Using the following as pipeline data input. \n{len(list_of_names)} USER UPLOADED FILE(S) : \n&#34;
                    + &#34;\n  📊⇢🧬 &#34;.join(
                        [
                            &#34;{:&gt;03d})\t{:&gt;50s}&#34;.format(i + 1, abi)
                            for i, abi in enumerate(sorted(list_of_names))
                        ]
                    )
                )

                app.logger.info(
                    f&#34;INITIALIZING NEW PIPELINE LAUNCH:\n\n\t\t{SESSION_OUTPUT_DIR}&#34;
                )

                start_time = tns()

                children = []
                parsed_upload_children = [
                    html.Details(
                        [
                            parse_contents(c, n, d, SESSION_OUTPUT_DIR, session_log_file=LOG_FILE)
                            for c, n, d in zip(list_of_contents, list_of_names, list_of_dates)
                        ]
                    )
                ]
                # Generate (single!) TCR alpha/beta chain pair combinations
                # base pipeline reference files (e.g., agg&#39;d fq, designated master
                # reference &#39;genome&#39;, DataFrames, log, etc.)
                try:
                    pipeline_output = ljoin(
                        [
                            r
                            for r in pipeline.run_pipeline(
                                RUN_ID,
                                SESSION_OUTPUT_DIR,
                                workflow=workflow,
                                session_log_file=LOG_FILE,
                            )
                        ]
                    )
                    args = [(*(x), i + 1) for i, x in enumerate(pipeline_output)]

                except Exception as e:
                    logs = []
                    report = None
                    with open(LOG_FILE, &#34;r+&#34;) as log_file:
                        for line in log_file.readlines():
                            logs.append(line)
                    stderr = [
                        dcc.Textarea(
                            placeholder=&#34;(Main Sequence -- logger placeholder)&#34;,
                            value=&#34;\n&#34;.join(logs),
                            style={
                                &#34;height&#34;: &#34;400px&#34;,
                                &#34;width&#34;: &#34;50%&#34;,
                                &#34;fontSize&#34;: &#34;0.7rem&#34;,
                                &#34;lineHeight&#34;: &#34;0.9rem&#34;,
                                &#34;fontFamily&#34;: &#34;&#39;Roboto Mono&#39;, monospace&#34;,
                            },
                            className=&#34;logger-text&#34;,
                            name=&#34;organization&#34;,
                            readOnly=True,
                        )
                    ]
                    fatal_crash = &#34;⚠ ALERT: ERROR IN MAIN PIPELINE SEQUENCE&#34;
                    app.logger.error(f&#34;{fatal_crash}: \n\n{e}&#34;)
                    log_exc(app.logger)
                    return html.Div(
                        [
                            html.H2(fatal_crash, style={&#34;color&#34;: &#34;red&#34;}),
                            html.P(f&#34;App runtime was: {gtt(start_time)}&#34;),
                            html.Code(f&#34;Primary error message for crash:\n{e}&#34;),
                            html.H4(&#34;See [end of] AUDIT LOG (below) for failure reason.&#34;),
                            html.H5(f&#34;WEB SERVER SYSTEM LOG:&#34;, style={&#34;color&#34;: &#34;red&#34;}),
                            html.Div(stderr),
                        ]
                    )

                ###   # # # # # # # # # #### # # # # # # # # #   ###
                children.append(
                    html.Div(
                        [
                            html.Hr(),
                            html.Br(),
                            html.H4(&#34;All files analyzed in most recent upload:&#34;),
                        ]
                    )
                )
                &#34;&#34;&#34;      ~ ◮ ~
                     S U M M A R Y
                 a  n  a  l  y  s  i  s
                     ~     ~     ~
                         ~ ◮ ~
                &#34;&#34;&#34;
                if report:
                    summary_report = [
                        html.Div(
                            [
                                html.Br(),
                                html.H2(
                                    &#34;Pipeline Output Summary&#34;,
                                    style={
                                        &#34;fontSize&#34;: &#34;80%&#34;,
                                        &#34;letterSpacing&#34;: &#34;1.33rem&#34;,
                                        &#34;fontFamily&#34;: &#34;Cinzel&#34;,
                                        &#34;animation&#34;: &#34;anim-text-flow-keys 120s infinite linear&#34;,
                                    },
                            ),
                                html.Hr(),
                            ],
                            style={&#34;width&#34;: &#34;90%&#34;, &#34;marginLeft&#34;: &#34;5%&#34;},
                        )
                    ]
                else:
                    summary_report = [html.Div([html.H4(f&#34;No final output found.&#34;)])]

                html_out = f&#34;{SESSION_OUTPUT_DIR}{RUN_ID}_HTMLprops.tsv&#34;
                pd.DataFrame(
                    [str(c.to_plotly_json()) for c in children], columns=[&#34;DashHTMLDivComponents&#34;]
                ).to_csv(html_out, encoding=&#34;utf-8&#34;, sep=&#34;\t&#34;)
                app.logger.info(&#34;Processed &amp; analzyed input files were:&#34;)
                app.logger.debug(parsed_upload_children)
                app.logger.info(&#34;,&#34;.join([str(type(x)) for x in parsed_upload_children]))
                total_exec_time = gtt(start_time)
                app.logger.info(
                    f&#34;———COMPLETE——-\n\n \t ☆☆☆ Total EXECUTION TIME Required ☆☆☆\n\n \t\t = {total_exec_time} s \n\n&#34;
                )
                show_exec_time = [
                    html.Div(
                        [
                            html.Hr(),
                            html.H3(
                                f&#34;* ﾟ(&gt;͂ ͡͡︒ ͜ ʖ ͡︒)&gt;-｡ﾟ☆* :・ﾟ.☆ * ･ &#34;
                            ),
                            html.H4(f&#34;Total Execution Time Required = {total_exec_time} s&#34;),
                            html.Hr(),
                            html.Br(),
                        ]
                    )
                ]

                if len(children) &gt; 50:
                    full_report = [
                        html.Div(
                            [
                                html.H2(
                                    f&#34;NOTICE: Due to an unusually large number of results in this analysis (N={len(children)}), full report display has been automatically disabled.&#34;
                                )
                            ]
                        )
                    ]
                else:
                    full_report = children

                children = (
                    show_exec_time
                    + TOC
                    + summary_report
                    + full_report
                    + parsed_upload_children
                    + [html.Div(html.Hr())]
                )

                app.logger.debug(&#34;,&#34;.join([str(type(x)) for x in children]))
                app.logger.debug(f&#34;Number of html.Div elements in final layout: {len(children)}&#34;)

                return children

        elif initiate_pipeline_n_clicks &gt; 15:
            return html.Div(
                [
                    html.H4(
                        &#34;⚠ | ALERT ! : Un𝒇ortunately, you have over-activated the pipeline submissions check system. Please re𝒇resh the page, re-log in, and re-upload the set o𝒇 ABI 𝒇iles you would like analyzed.  🛠⎆ &#34;
                    ),
                    html.H6(&#34;↺ Please Re𝒇resh the page. ↺&#34;),
                ]
            )

        if clear_uploads_n_clicks &gt; 0:
            t_elapsed = tns() / 1e9 - clear_uploads_timestamp / 1e3
            if t_elapsed &lt; 2:
                for tcr_dir in os.listdir(SESSION_OUTPUT_DIR):
                    grouped_clone_fqs = f&#34;{SESSION_OUTPUT_DIR}{tcr_dir}&#34;
                    if os.path.isdir(grouped_clone_fqs):
                        shutil.rmtree(grouped_clone_fqs)
                return html.Div(
                    [
                        html.Code(f&#34;UPLOADS CLEARED&#34;, style={&#34;color&#34;: &#34;red&#34;}),
                        html.H5(
                            f&#39;To continue, submit at least one new upload &amp; click &#34;✥ Append&#34;.&#39;
                        ),
                    ]
                )

        if append_uploads_n_clicks &gt; 0 or clear_uploads_n_clicks &gt; 0:
            if len(list_of_names) &gt; 0 and len(memory.items()) &gt; 0:
                all_uploads = (
                    memory[f&#34;{RUN_ID}-list_of_names&#34;]
                    if len(memory[f&#34;{RUN_ID}-list_of_names&#34;]) &gt; 0
                    else list_of_names
                )
                return show_list_of_names(USER, all_uploads)
            elif len(memory.items()) == 0:
                return html.Div(html.Code(&#34;NONE&#34;))
        else:
            app.logger.info(
                f&#34;{USER} uploaded the following {len(list_of_names)} file(s):&#34;
                + &#34;\n\t ◇ 📄 &#34;
                + &#34;\n\t ◇ 📄 &#34;.join(sorted(list_of_names))
                + &#34;.\n&#34;
            )
            return show_list_of_names(USER, list_of_names)

    else:
        return html.Div(
            [html.Br(), html.H5(f&#34;Logged in as: {USER}&#34;, style={&#34;color&#34;: &#34;rgb(32,92,188)&#34;})]
        )</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.update_workflow_choice"><code class="name flex">
<span>def <span class="ident">update_workflow_choice</span></span>(<span>workflow)</span>
</code></dt>
<dd>
<div class="desc"><p>Update display at top of app based on USER's Worlflow selection
(e.g., "Gene Editing: [&hellip;]", etc.)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>workflow</code></strong></dt>
<dd>str</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Array of H2 HTML Header element containing workflow text.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(Output(f&#34;workflow-selection&#34;, &#34;children&#34;), [Input(f&#34;workflow-id&#34;, &#34;value&#34;)])
def update_workflow_choice(workflow):
    &#34;&#34;&#34;Update display at top of app based on USER&#39;s Worlflow selection
    (e.g., &#34;Gene Editing: [...]&#34;, etc.)
    
    Args:
        workflow: str
    
    Returns:
        Array of H2 HTML Header element containing workflow text.
    &#34;&#34;&#34;
    app.logger.debug(f&#34;CALLBACK:::`update_workflow_choice` triggered with value: {workflow}&#34;)
    return [html.H2(f&#34;{workflow}&#34;, style={&#34;textAlign&#34;: &#34;center&#34;})]</code></pre>
</details>
</dd>
<dt id="dash-webapp-template.seqapp.callbacks.zip_all_downloadables"><code class="name flex">
<span>def <span class="ident">zip_all_downloadables</span></span>(<span>getZipped_n_clicks, value, session_data)</span>
</code></dt>
<dd>
<div class="desc"><p>Create a downloadable zip of USER selected set of output files.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>getZipped_n_clicks</code></strong></dt>
<dd>int</dd>
<dt><strong><code>value</code></strong></dt>
<dd>str</dd>
<dt><strong><code>session_data</code></strong></dt>
<dd>Dash.dcc.Store(type='session')</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>html.Div([]): Dash HTML div component↦ itself an array of Dash HTML components</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.callback(
    Output(f&#34;download-all&#34;, &#34;children&#34;),
    [Input(f&#34;request-all-zipped&#34;, &#34;n_clicks&#34;)],
    [State(f&#34;download-dropdown&#34;, &#34;value&#34;), State(f&#34;session&#34;, &#34;data&#34;)],
)
def zip_all_downloadables(getZipped_n_clicks, value, session_data):
    &#34;&#34;&#34;Create a downloadable zip of USER selected set of output files.
    
    Args:
        getZipped_n_clicks: int
        value: str
        session_data: Dash.dcc.Store(type=&#39;session&#39;)
    
    Returns:
        html.Div([]): Dash HTML div component↦ itself an array of Dash HTML components
    &#34;&#34;&#34;
    if getZipped_n_clicks &gt; 0 and any(session_data):
        selection = output_filetype_genres[value]
        session_output = session_data[&#34;PATH_TO_SESSION_OUTPUT&#34;]
        RUN_ID = session_data[&#34;RUN_ID&#34;]
        source = session_output if value != &#34;REF&#34; else PLASMIDS_ARCHIVE
        files = get_output_files(selection, final_output_dir=source)
        zipped = re.sub(&#34;[&#39;\ \(\)]&#34;, &#34;&#34;, f&#34;{session_output}{RUN_ID}_{clock()[-4:]}.zip&#34;)
        for i, filename in enumerate(files):
            fbn = f&#34;{os.path.basename(filename)}&#34;
            app.logger.info(f&#34;{i}: Adding file {filename} to new zipped archive: {fbn}...&#34;)
            with zipfile.ZipFile(zipped, &#34;a&#34;) as zipf:
                zipf.write(filename, fbn)
        return html.Div(
            [
                html.H4(f&#34;Zip⇝⇶🗃⇨Download All:&#34;),
                html.H4([html.Li(file_download_link(zipped), className=&#34;zip-dl-link&#34;)]),
            ]
        )</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#john-collins-github-public-repos-dash-webapp-template">John Collins GitHub Public Repos — dash-webapp-template</a></li>
<li><a href="#attributes">Attributes:</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="dash-webapp-template.seqapp" href="index.html">dash-webapp-template.seqapp</a></code></li>
</ul>
</li>
<li><h3><a href="#header-variables">Global variables</a></h3>
<ul class="">
<li><code><a title="dash-webapp-template.seqapp.callbacks.logger" href="#dash-webapp-template.seqapp.callbacks.logger">logger</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="dash-webapp-template.seqapp.callbacks.clear_dd1_selection" href="#dash-webapp-template.seqapp.callbacks.clear_dd1_selection">clear_dd1_selection</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.clear_dd2_selection" href="#dash-webapp-template.seqapp.callbacks.clear_dd2_selection">clear_dd2_selection</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.confirm_new_session" href="#dash-webapp-template.seqapp.callbacks.confirm_new_session">confirm_new_session</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.display_generated_dd_output" href="#dash-webapp-template.seqapp.callbacks.display_generated_dd_output">display_generated_dd_output</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.download_all_selected" href="#dash-webapp-template.seqapp.callbacks.download_all_selected">download_all_selected</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.download_file" href="#dash-webapp-template.seqapp.callbacks.download_file">download_file</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.enable_combined_file_uploads" href="#dash-webapp-template.seqapp.callbacks.enable_combined_file_uploads">enable_combined_file_uploads</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.log_out_or_comeback" href="#dash-webapp-template.seqapp.callbacks.log_out_or_comeback">log_out_or_comeback</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.record_user_name" href="#dash-webapp-template.seqapp.callbacks.record_user_name">record_user_name</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.show_pipeline_commands" href="#dash-webapp-template.seqapp.callbacks.show_pipeline_commands">show_pipeline_commands</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.show_user_in_menubar" href="#dash-webapp-template.seqapp.callbacks.show_user_in_menubar">show_user_in_menubar</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.trigger_dropdowns" href="#dash-webapp-template.seqapp.callbacks.trigger_dropdowns">trigger_dropdowns</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.update_dropdown" href="#dash-webapp-template.seqapp.callbacks.update_dropdown">update_dropdown</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.update_link" href="#dash-webapp-template.seqapp.callbacks.update_link">update_link</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.update_output" href="#dash-webapp-template.seqapp.callbacks.update_output">update_output</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.update_workflow_choice" href="#dash-webapp-template.seqapp.callbacks.update_workflow_choice">update_workflow_choice</a></code></li>
<li><code><a title="dash-webapp-template.seqapp.callbacks.zip_all_downloadables" href="#dash-webapp-template.seqapp.callbacks.zip_all_downloadables">zip_all_downloadables</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>